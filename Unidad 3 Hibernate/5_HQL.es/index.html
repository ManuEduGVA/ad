
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="http://sitename.example.com/Unidad%203%20Hibernate/5_HQL.es/">
      
      
        <link rel="prev" href="../4_Relationships.es/">
      
      
      
      <link rel="icon" href="../../assets/Cheste.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.22">
    
    
      
        <title>5. Hibernate Query Language - Acceso a Datos</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.84d31ad4.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,700,700i%7CRed+Hat+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Open Sans";--md-code-font:"Red Hat Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="blue-grey" data-md-color-accent="deep-purple">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#5-hibernate-query-language" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Acceso a Datos" class="md-header__button md-logo" aria-label="Acceso a Datos" data-md-component="logo">
      
  <img src="../../assets/Cheste.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Acceso a Datos
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              5. Hibernate Query Language
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="blue-grey" data-md-color-accent="deep-purple"  aria-label="Dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="deep-orange"  aria-label="Light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Acceso a Datos" class="md-nav__button md-logo" aria-label="Acceso a Datos" data-md-component="logo">
      
  <img src="../../assets/Cheste.png" alt="logo">

    </a>
    Acceso a Datos
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Inicio
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Unidad 1 Ficheros
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Unidad 1 Ficheros
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Unidad%201%20Ficheros/1_File_System.es/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    1. Sistema de archivos
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Unidad%201%20Ficheros/2_Reading_and_writing_files.es/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    2. Lectura y escritura de archivos
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Unidad%201%20Ficheros/3_XML_Files.es/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    3. Archivos XML
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Unidad%201%20Ficheros/4_JSON_Files.es/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    4. Archivos JSON
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Unidad%201%20Ficheros/5_Extra_Formats.es/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    5. Formatos extra
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Unidad%201%20Ficheros/6_Ejercicios.es/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Ejercicios sistema de archivos
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Unidad 2 Conectores de BBDD
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Unidad 2 Conectores de BBDD
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Unidad%202%20Conectores%20de%20BBDD/1_Object_relational_impedance_mismatch.es/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    1. Desfase objeto-relacional
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Unidad%202%20Conectores%20de%20BBDD/2_Connectors.es/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    2. Conectores
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Unidad%202%20Conectores%20de%20BBDD/3_Connecting.es/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    3. Conectando a bases de datos
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Unidad%202%20Conectores%20de%20BBDD/4_Resultset.es/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    4. Clase ResultSet.
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Unidad%202%20Conectores%20de%20BBDD/5_Metadata.es/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    5. Metadata de la base de datos
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Unidad%202%20Conectores%20de%20BBDD/6_CRUD.es/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    6. Statements and CRUD operations
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Unidad%202%20Conectores%20de%20BBDD/7_Row_to_Object.es/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    7. De filas a Objetos
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Unidad%202%20Conectores%20de%20BBDD/clienteSQL/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Actividad Cliente MySQL
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Unidad 3 Hibernate
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Unidad 3 Hibernate
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../1_Mapping.es/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    1 Mapping
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../2_Hibernate.es/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    2. Hibernate
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../3_Entities_Beans.es/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    3. Mapeo de Entidades con JPA y Hibernate
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../4_Relationships.es/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    4. Mapeando Relaciones
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    5. Hibernate Query Language
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    5. Hibernate Query Language
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#51-recuperando-objetos" class="md-nav__link">
    <span class="md-ellipsis">
      5.1. Recuperando objetos
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#52-consultas" class="md-nav__link">
    <span class="md-ellipsis">
      5.2. Consultas
    </span>
  </a>
  
    <nav class="md-nav" aria-label="5.2. Consultas">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#521-obteniendo-objetos-simples" class="md-nav__link">
    <span class="md-ellipsis">
      5.2.1. Obteniendo objetos simples
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#522-obteniendo-objetos-compuestos" class="md-nav__link">
    <span class="md-ellipsis">
      5.2.2. Obteniendo objetos compuestos
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#53-parametros-y-consultas-nominales-con-nombre" class="md-nav__link">
    <span class="md-ellipsis">
      5.3. Parámetros y Consultas Nominales (con nombre)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="5.3. Parámetros y Consultas Nominales (con nombre)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#531-parametros-posicionales" class="md-nav__link">
    <span class="md-ellipsis">
      5.3.1. Parámetros posicionales
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#532-parametros-nominales" class="md-nav__link">
    <span class="md-ellipsis">
      5.3.2. Parámetros nominales
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#533-consultas-con-nombre" class="md-nav__link">
    <span class="md-ellipsis">
      5.3.3. Consultas con nombre
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#54-crud" class="md-nav__link">
    <span class="md-ellipsis">
      5.4. CRUD
    </span>
  </a>
  
    <nav class="md-nav" aria-label="5.4. CRUD">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#541-crear-create-insert" class="md-nav__link">
    <span class="md-ellipsis">
      5.4.1. Crear (Create - Insert)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#542-actualizacion-update" class="md-nav__link">
    <span class="md-ellipsis">
      5.4.2. Actualización (Update)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#543-eliminacion-delete" class="md-nav__link">
    <span class="md-ellipsis">
      5.4.3. Eliminación (Delete)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#55-apendice-estado-de-los-objetos" class="md-nav__link">
    <span class="md-ellipsis">
      5.5. Apéndice, Estado de los objetos
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#51-recuperando-objetos" class="md-nav__link">
    <span class="md-ellipsis">
      5.1. Recuperando objetos
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#52-consultas" class="md-nav__link">
    <span class="md-ellipsis">
      5.2. Consultas
    </span>
  </a>
  
    <nav class="md-nav" aria-label="5.2. Consultas">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#521-obteniendo-objetos-simples" class="md-nav__link">
    <span class="md-ellipsis">
      5.2.1. Obteniendo objetos simples
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#522-obteniendo-objetos-compuestos" class="md-nav__link">
    <span class="md-ellipsis">
      5.2.2. Obteniendo objetos compuestos
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#53-parametros-y-consultas-nominales-con-nombre" class="md-nav__link">
    <span class="md-ellipsis">
      5.3. Parámetros y Consultas Nominales (con nombre)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="5.3. Parámetros y Consultas Nominales (con nombre)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#531-parametros-posicionales" class="md-nav__link">
    <span class="md-ellipsis">
      5.3.1. Parámetros posicionales
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#532-parametros-nominales" class="md-nav__link">
    <span class="md-ellipsis">
      5.3.2. Parámetros nominales
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#533-consultas-con-nombre" class="md-nav__link">
    <span class="md-ellipsis">
      5.3.3. Consultas con nombre
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#54-crud" class="md-nav__link">
    <span class="md-ellipsis">
      5.4. CRUD
    </span>
  </a>
  
    <nav class="md-nav" aria-label="5.4. CRUD">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#541-crear-create-insert" class="md-nav__link">
    <span class="md-ellipsis">
      5.4.1. Crear (Create - Insert)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#542-actualizacion-update" class="md-nav__link">
    <span class="md-ellipsis">
      5.4.2. Actualización (Update)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#543-eliminacion-delete" class="md-nav__link">
    <span class="md-ellipsis">
      5.4.3. Eliminación (Delete)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#55-apendice-estado-de-los-objetos" class="md-nav__link">
    <span class="md-ellipsis">
      5.5. Apéndice, Estado de los objetos
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="5-hibernate-query-language">5. Hibernate Query Language</h1>
<p>La documentación completa se puede encontrar aquí:</p>
<ul>
<li>In <a href="https://docs.jboss.org/hibernate/core/3.6/reference/es-ES/html/queryhql.html">spanish</a></li>
<li>In <a href="https://docs.jboss.org/hibernate/core/4.3/manual/en-US/html/ch16.html">english</a></li>
</ul>
<p>El lenguaje HQL (Hibernate Query Language) nació con el objetivo de preservar el modelo relacional, ya que es un superset de SQL (extensión de SQL que incluye SQL). La primera consideración es que, por defecto, su funcionalidad es recuperar objetos de la base de datos, no tablas como hacíamos en el lenguaje SQL a través de <code>ResultSet</code>. Las consultas con HQL se realizarán desde una interfaz <strong>Query</strong>, que será el lugar donde especificaremos qué queremos obtener. Opcionalmente, podemos añadir a la consulta los parámetros necesarios para su ejecución, para evitar consultas con código duro.</p>
<p>En primer lugar, la consulta será preparada. Al crearla, debemos tener en cuenta dos opciones, con cuatro combinaciones posibles:</p>
<ul>
<li>Devolverá un resultado o más de uno y,</li>
<li>Devolverá el resultado encapsulado en objetos o de forma compuesta.</li>
</ul>
<p>Dependiendo de la respuesta obtenida, en el segundo paso escogeremos una de las cuatro opciones vistas a continuación.</p>
<div class="language-java highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="mi">1</span><span class="w"> </span><span class="n">Query</span><span class="w"> </span><span class="n">q</span><span class="o">=</span><span class="n">session</span><span class="p">.</span><span class="na">createQuery</span><span class="p">(</span><span class="s">&quot;HQL statement&quot;</span><span class="p">);</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="mf">2.1</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="n">Object</span><span class="o">&gt;</span><span class="w"> </span><span class="n">resultsObjects</span><span class="o">=</span><span class="n">q</span><span class="p">.</span><span class="na">list</span><span class="p">();</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="mf">2.2</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="n">Object</span><span class="w"> </span><span class="o">[]&gt;</span><span class="n">mixedresults</span><span class="o">=</span><span class="n">q</span><span class="p">.</span><span class="na">list</span><span class="p">();</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="mf">2.3</span><span class="w"> </span><span class="n">Object</span><span class="w"> </span><span class="n">result</span><span class="o">=</span><span class="n">q</span><span class="p">.</span><span class="na">uniqueResult</span><span class="p">();</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="mf">2.4</span><span class="w"> </span><span class="n">Object</span><span class="o">[]</span><span class="w"> </span><span class="n">result</span><span class="o">=</span><span class="n">q</span><span class="p">.</span><span class="na">uniqueResult</span><span class="p">();</span>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="mf">1.</span><span class="w"> </span><span class="c1">// process information obtained</span>
</span></code></pre></div>
<ol>
<li>In first option the query returns a collection of objects (several rows, on object in a row).</li>
<li>Esta opción regresa a la colección s composite of objects and another types: for example a Student en number of topics and number of teachers.</li>
<li>Las opciones más recientes son, instead de la colección, las respuestas a un object/composite.</li>
</ol>
<div class="admonition note">
<p class="admonition-title">Apunte...</p>
</div>
<ul>
<li><code>session.createQuery</code> → permite escribir una consulta HQL, con o sin parámetros. </li>
<li>
<p><code>Query.list()</code> → obtiene todos los objetos (como una Lista) de la base de datos que satisfacen la consulta. </p>
</li>
<li>
<p><code>Query.uniqueResult()</code> → obtiene un único objeto de la base de datos.</p>
</li>
</ul>
<p>Antes de los detalles, aquí encontrarás algunas ideas generales:</p>
<ul>
<li>Podemos eliminar el <code>Select*</code>, para indicar que queremos todos los atributos.</li>
<li>Hay una sensibilidad media a las mayúsculas y minúsculas: las palabras reservadas de HQL no distinguen entre mayúsculas y minúsculas, pero las referencias a los objetos (sus nombres) sí lo hacen: no importa poner <code>From</code> o <code>fROm</code>, pero un <code>Student</code> no es lo mismo que un <code>student</code>. Se recomienda escribir las sentencias en minúsculas para distinguirlas de las clases.</li>
<li>Después de <code>from</code>, aparece el nombre de una clase (o clases), no de tablas.</li>
<li>Asignar sobrenombre es altamente recomendable. Podemos utilizar joins de forma similar a SQL.</li>
<li>Luego puede aparecer el <code>where</code>, con sus condiciones similares a SQL.</li>
<li>Las constantes de texto se cierran entre comillas simples.</li>
<li>Podemos consultar colecciones que aparecen dentro de los objetos (por ejemplo, el conjunto de estudiantes de un profesor).</li>
<li>No hay operador <code>limite</code>.</li>
<li><code>order by</code> se utiliza de forma similar a SQL.</li>
<li><code>group by</code> está permitido, y las funciones agregadas son: COUNT, AVG, SUM, MIN y MAX.</li>
</ul>
<h2 id="51-recuperando-objetos">5.1. Recuperando objetos</h2>
<p>A partir de ahora, los ejemplos se basan en este esquema <a href="../DocenciaConsultas.sql">Docencia</a></p>
<figure>
  <img alt="Image title" src="../img/DocenciaHQL.png" width="700" />
<br />
<figcaption>Docencia HQL<figcaption>
</figcaption>
</figure>
<div class="admonition tip">
<p class="admonition-title">Consejo</p>
</div>
<p>Ahora es un buen momento para intentar realizar un enfoque de ingeniería inversa para construir tu proyecto a partir de la base de datos.</p>
<h2 id="52-consultas">5.2. Consultas</h2>
<h3 id="521-obteniendo-objetos-simples">5.2.1. Obteniendo objetos simples</h3>
<p>Estas consultas son las que queremos recuperar un objeto o una colección de éstos de la base de datos (una o más filas, en comparación con ResultSet). Cada resultado es un único objeto de una tabla de la base de datos. Se caracterizarán porque la palabra Select puede no aparecer o simplemente indicar el sobrenombre de la clase que tenemos. Veamos los ejemplos.</p>
<p>El siguiente ejemplo muestra a todos los estudiantes:</p>
<div class="language-java highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="c1">// complete and polite</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="n">Query</span><span class="o">&lt;</span><span class="n">Alumno</span><span class="o">&gt;</span><span class="w"> </span><span class="n">q</span><span class="o">=</span><span class="n">laSesion</span><span class="p">.</span><span class="na">createQuery</span><span class="p">(</span><span class="s">&quot;Select a from Alumno a&quot;</span><span class="p">);</span>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="c1">// ORO</span>
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a>
</span><span id="__span-1-6"><a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a><span class="c1">// in a quick way</span>
</span><span id="__span-1-7"><a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a><span class="n">Query</span><span class="o">&lt;</span><span class="n">Alumno</span><span class="o">&gt;</span><span class="w"> </span><span class="n">q</span><span class="o">=</span><span class="n">laSesion</span><span class="p">.</span><span class="na">createQuery</span><span class="p">(</span><span class="s">&quot;from Alumno&quot;</span><span class="p">);</span>
</span><span id="__span-1-8"><a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a>
</span><span id="__span-1-9"><a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a><span class="c1">// quickest (without type)</span>
</span><span id="__span-1-10"><a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a><span class="n">Query</span><span class="w"> </span><span class="n">q</span><span class="o">=</span><span class="n">laSesion</span><span class="p">.</span><span class="na">createQuery</span><span class="p">(</span><span class="s">&quot;from Alumno&quot;</span><span class="p">);</span>
</span><span id="__span-1-11"><a id="__codelineno-1-11" name="__codelineno-1-11" href="#__codelineno-1-11"></a>
</span><span id="__span-1-12"><a id="__codelineno-1-12" name="__codelineno-1-12" href="#__codelineno-1-12"></a><span class="n">List</span><span class="o">&lt;</span><span class="n">Student</span><span class="o">&gt;</span><span class="w"> </span><span class="n">losAlumnos</span><span class="o">=</span><span class="n">q</span><span class="p">.</span><span class="na">list</span><span class="p">();</span>
</span><span id="__span-1-13"><a id="__codelineno-1-13" name="__codelineno-1-13" href="#__codelineno-1-13"></a>
</span><span id="__span-1-14"><a id="__codelineno-1-14" name="__codelineno-1-14" href="#__codelineno-1-14"></a><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">Alumno</span><span class="w"> </span><span class="n">alumno</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">losAlumnos</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span>
</span><span id="__span-1-15"><a id="__codelineno-1-15" name="__codelineno-1-15" href="#__codelineno-1-15"></a><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">alumno</span><span class="p">);</span><span class="w"> </span>
</span><span id="__span-1-16"><a id="__codelineno-1-16" name="__codelineno-1-16" href="#__codelineno-1-16"></a><span class="p">}</span>
</span></code></pre></div>
<p>Si queremos filtrar o buscar a cualquier estudiante, necesitamos utilizar la cláusula <code>where</code>, como en una consulta SQL normal. Las expresiones pueden ser:</p>
<figure>
  <img alt="Image title" src="../img/Where.png" width="700" />
<br />
<figcaption>Where<figcaption>
</figcaption>
</figure>
<p>Cuando el filtro <code>where</code> sólo devuelve un objeto, podríamos almacenarlo en una lista y después acceder a él, pero es mejor obtener el objeto directamente, como sigue:</p>
<p><div class="language-java highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="n">Query</span><span class="o">&lt;</span><span class="n">Alumno</span><span class="o">&gt;</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">laSesion</span><span class="p">.</span><span class="na">createQuery</span><span class="p">(</span><span class="s">&quot;Select from Alumno a where a.idAlumno=1&quot;</span><span class="p">);</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="n">Alumno</span><span class="w"> </span><span class="n">alumno</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">q</span><span class="p">.</span><span class="na">uniqueResult</span><span class="p">();</span>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">alumno</span><span class="p">);</span>
</span></code></pre></div>
ten en cuenta que creamos nuestra consulta con el operador diamante, indicando que devolverá un estudiante. Entonces, la consulta devuelve obviamente al estudiante. La alternativa es realizar un casting del objeto devuelto de <code>uniqueResult</code>:</p>
<div class="language-java highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="n">Query</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">laSesion</span><span class="p">.</span><span class="na">createQuery</span><span class="p">(</span><span class="s">&quot;Select from Alumno a where a.idAlumno=1&quot;</span><span class="p">);</span>
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="n">Alumno</span><span class="w"> </span><span class="n">alumno</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">Alumno</span><span class="p">)</span><span class="n">q</span><span class="p">.</span><span class="na">uniqueResult</span><span class="p">();</span>
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">alumno</span><span class="p">);</span>
</span></code></pre></div>
<div class="admonition warning">
<p class="admonition-title">Atención</p>
</div>
<p>Tenga cuidado cuando recupere un objeto único y la consulta devuelve varios. </p>
<div class="language-java highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="n">Query</span><span class="w"> </span><span class="n">q</span><span class="o">=</span><span class="n">laSesion</span><span class="p">.</span><span class="na">createQuery</span><span class="p">(</span><span class="s">&quot;Select from Student a where a.age=24&quot;</span><span class="p">);</span><span class="w"> </span>
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="n">Alumno</span><span class="w"> </span><span class="n">a</span><span class="o">=</span><span class="p">(</span><span class="n">Studente</span><span class="p">)</span><span class="w"> </span><span class="n">q</span><span class="p">.</span><span class="na">uniqueResult</span><span class="p">();</span><span class="w"> </span>
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a><span class="c1">// org.hibernate.NonUniqueResultException: query did not return a unique result: 2 </span>
</span></code></pre></div>
<p>Cuando tenemos muchos resultados, no es conveniente recuperarlos todos a la vez, sino acceder a ellos de 10 en 10 o similar, al igual que las páginas de búsqueda de Google o Amazon. Podemos conseguirlo lanzando consultas más pequeñas repetidamente, aplicando a la consulta:</p>
<ul>
<li><code>Q.setFirstResult(int start)</code> → indica el primer objeto (fila) a devolver.</li>
<li><code>Q.setMaxResult(int howMany)</code> → indica cuántas filas devolverá.</li>
</ul>
<p>Con un algoritmo diseñado adecuadamente, podemos realizar un bucle, desplazando el inicio en cada iteración, incrementándolo por el número de filas recuperadas en la iteración anterior. Esto implicaría muchas consultas pequeñas en lugar de una grande.</p>
<h3 id="522-obteniendo-objetos-compuestos">5.2.2. Obteniendo objetos compuestos</h3>
<p>Si necesitamos obtener más (o menos) datos que un objeto entero, debemos hacerlo en la parte <code>select</code> de la cláusula, pero cuando obtenemos los datos no los podemos almacenar en un Object. Por esta razón, y utilizando la propiedad de polimorfismo de Java, obtenemos los resultados en un array genérico de objetos. Por tanto, debemos ser muy cuidadosos con el tipo de cada celda, así como el tamaño de este array, ya que estará fuertemente ligado a la consulta en sí. Veamos la siguiente consulta: <em>Muestra el nombre y la edad de los estudiantes</em>:</p>
<div class="language-java highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="n">Query</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">laSesion</span><span class="p">.</span><span class="na">createQuery</span><span class="p">(</span><span class="s">&quot;Select a.número,a.edad from Alumno a&quot;</span><span class="p">);</span>
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a>
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a><span class="n">List</span><span class="o">&lt;</span><span class="n">Object</span><span class="o">[]&gt;</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">q</span><span class="p">.</span><span class="na">list</span><span class="p">();</span>
</span><span id="__span-5-4"><a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a>
</span><span id="__span-5-5"><a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">Object</span><span class="o">[]</span><span class="w"> </span><span class="n">objects</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">result</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span>
</span><span id="__span-5-6"><a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">print</span><span class="p">(</span><span class="s">&quot;Alumno: &quot;</span><span class="p">);</span><span class="w"> </span>
</span><span id="__span-5-7"><a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">objects</span><span class="p">.</span><span class="na">length</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span>
</span><span id="__span-5-8"><a id="__codelineno-5-8" name="__codelineno-5-8" href="#__codelineno-5-8"></a><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">print</span><span class="p">(</span><span class="n">objects</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot; &quot;</span><span class="p">);</span><span class="w"> </span>
</span><span id="__span-5-9"><a id="__codelineno-5-9" name="__codelineno-5-9" href="#__codelineno-5-9"></a><span class="p">}</span><span class="w"> </span>
</span><span id="__span-5-10"><a id="__codelineno-5-10" name="__codelineno-5-10" href="#__codelineno-5-10"></a><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">();</span>
</span><span id="__span-5-11"><a id="__codelineno-5-11" name="__codelineno-5-11" href="#__codelineno-5-11"></a><span class="p">}</span>
</span></code></pre></div>
<p>Ten en cuenta que si sólo quieres imprimir la información, no es necesario realizar ningún trabajo extra, ya que (casi) todos los objetos se pueden convertir a String. Si quieres utilizarlos de otra manera, tenga mucho cuidado al convertirlos al tipo de dato adecuado.</p>
<p><strong>Colecciones</strong></p>
<p>Vamos a comprobar el nombre de los estudiantes y cuántos exámenes han realizado. Esta información se encuentra en el conjunto de Exámenes, así que necesitaremos manipular esta colección:</p>
<div class="language-java highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="n">Query</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">laSesion</span><span class="p">.</span><span class="na">createQuery</span><span class="p">(</span><span class="s">&quot;Select a.número,size(a.exámenes) from Alumno a&quot;</span><span class="p">);</span>
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a><span class="n">List</span><span class="o">&lt;</span><span class="n">Object</span><span class="o">[]&gt;</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">q</span><span class="p">.</span><span class="na">list</span><span class="p">();</span>
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a>
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">Object</span><span class="o">[]</span><span class="w"> </span><span class="n">alu</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">result</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span>
</span><span id="__span-6-5"><a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Alumno: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">alu</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot; has done &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">alu</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot; exams.&quot;</span><span class="p">);</span>
</span><span id="__span-6-6"><a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a><span class="p">}</span>
</span></code></pre></div>
<p>Como puede ver, hemos aplicado la función <code>size()</code> a la colección para ver su tamaño. Por tanto, podemos aplicar:</p>
<ul>
<li><code>size(collection)</code> → recuperar el tamaño de la colección.</li>
<li><code>collection is empty</code> | <code>collection is not empty</code> → para determinar si está vacía. Es equivalente a comparar el tamaño con 0.</li>
<li>Los operadores <code>in</code>, <code>all</code> se pueden combinar utilizando el operador <code>elements(collection)</code>.</li>
</ul>
<p>Como consulta avanzada, puede utilizar <code>exists</code> y <code>not exists</code> en sus consultas.</p>
<h2 id="53-parametros-y-consultas-nominales-con-nombre">5.3. Parámetros y Consultas Nominales (con nombre)</h2>
<p>Normalmente, la mayoría de las consultas necesitarán algunos parámetros, generalmente para el filtrado de objetos en la cláusula where. Los beneficios de parametrizar las consultas para evitar la inyección de SQL o problemas similares se discutieron ya en la unidad anterior.</p>
<p>La gestión de los parámetros se realiza de la misma forma que con las sentencias preparadas (<code>preparedStatements</code>), y se puede realizar mediante parámetros posicionales o nominales. Veamos algunos ejemplos:</p>
<h3 id="531-parametros-posicionales">5.3.1. Parámetros posicionales</h3>
<p>Debemos añadir espacios reservados dentro de nuestra consulta, pero en lugar de <code>?</code> añadimos un número después del signo de interrogación. Después debemos configurar el parámetro según el número de espacio reservado que hemos establecido antes, de la siguiente forma:</p>
<div class="language-java highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="n">Query</span><span class="o">&lt;</span><span class="n">Alumno</span><span class="o">&gt;</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">laSesion</span><span class="p">.</span><span class="na">createQuery</span><span class="p">(</span><span class="s">&quot;Select from Alumno a where a.edad=?1&quot;</span><span class="p">);</span>
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a><span class="n">q</span><span class="p">.</span><span class="na">setParameter</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">24</span><span class="p">);</span>
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a><span class="n">List</span><span class="o">&lt;</span><span class="n">Alumno</span><span class="o">&gt;</span><span class="w"> </span><span class="n">losAlumnos</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">q</span><span class="p">.</span><span class="na">list</span><span class="p">();</span>
</span><span id="__span-7-4"><a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a>
</span><span id="__span-7-5"><a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">Alumno</span><span class="w"> </span><span class="n">alumno</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">losAlumnos</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span>
</span><span id="__span-7-6"><a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">alumno</span><span class="p">);</span>
</span><span id="__span-7-7"><a id="__codelineno-7-7" name="__codelineno-7-7" href="#__codelineno-7-7"></a><span class="p">}</span>
</span></code></pre></div>
<div class="admonition tip">
<p class="admonition-title">Consejo</p>
</div>
<p>Ten en cuenta que el método <code>setParameter</code> está sobrecargado para establecer todo tipo de datos.</p>
<h3 id="532-parametros-nominales">5.3.2. Parámetros nominales</h3>
<p>Las posiciones están bien, pero si podemos indicar los parámetros de forma nominal, el programa será mucho más legible. Los parámetros se indican con <code>:nombreDelParametro</code> y se asignarán con el método <code>setParameter(nombreDelParametro, valor)</code>, indicando el nombre del parámetro (sin los dos puntos):</p>
<h3 id="533-consultas-con-nombre">5.3.3. Consultas con nombre</h3>
<p>Podemos escribir consultas en nuestros métodos según las necesitemos. Sin embargo, es una buena práctica crear las consultas más importantes o que prevemos que serán las más utilizadas junto con la misma clase,a través del mecanismo que se presenta a continuación. En esta sección creamos y etiquetamos nuestras consultas, dentro de una colección de consultas, y después las podemos llamar. Es como si creáramos una biblioteca de consultas.</p>
<p>Fuera de la definición de la clase, se creará una colección <code>@NamedQueries</code>, que contendrá un array (indicado por claves) de elementos <code>@NamedQuery</code>, cada uno de ellos con un <strong>nombre</strong> y una definición de <strong>consulta</strong>.</p>
<p>Para invocarlas, en lugar de crear un objeto <code>Query</code>, lo crearemos a través de una <code>NamedQuery</code>, indicando su nombre y asignando parámetros, si los hubiere.</p>
<p>En la clase Alumno:</p>
<div class="language-java highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="nd">@Entity</span>
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a><span class="nd">@Table</span><span class="p">(</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Alumno&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">catalogo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;DocenciaConsultas&quot;</span><span class="p">)</span>
</span><span id="__span-8-3"><a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a><span class="nd">@NamedQueries</span><span class="p">({</span><span class="w"> </span>
</span><span id="__span-8-4"><a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a><span class="nd">@NamedQuery</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;Repetidores&quot;</span><span class="p">,</span><span class="w"> </span>
</span><span id="__span-8-5"><a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a><span class="n">query</span><span class="o">=</span><span class="s">&quot;select from Student en where a.repeater=true &quot;</span><span class="p">),</span><span class="w"> </span>
</span><span id="__span-8-6"><a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a><span class="nd">@NamedQuery</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;AlumnosEntre&quot;</span><span class="p">,</span><span class="w"> </span>
</span><span id="__span-8-7"><a id="__codelineno-8-7" name="__codelineno-8-7" href="#__codelineno-8-7"></a><span class="n">query</span><span class="o">=</span><span class="s">&quot;select en Student en where a.age between :min and :max&quot;</span><span class="p">),</span><span class="w"> </span>
</span><span id="__span-8-8"><a id="__codelineno-8-8" name="__codelineno-8-8" href="#__codelineno-8-8"></a><span class="nd">@NamedQuery</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;AlumnosDescAge&quot;</span><span class="p">,</span><span class="w"> </span>
</span><span id="__span-8-9"><a id="__codelineno-8-9" name="__codelineno-8-9" href="#__codelineno-8-9"></a><span class="n">query</span><span class="o">=</span><span class="s">&quot;select a from Student a order by a.age desc&quot;</span><span class="p">)</span>
</span><span id="__span-8-10"><a id="__codelineno-8-10" name="__codelineno-8-10" href="#__codelineno-8-10"></a><span class="p">})</span>
</span><span id="__span-8-11"><a id="__codelineno-8-11" name="__codelineno-8-11" href="#__codelineno-8-11"></a><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Alumno</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">java</span><span class="p">.</span><span class="na">io</span><span class="p">.</span><span class="na">Serializable</span><span class="w"> </span><span class="p">{</span><span class="w"> </span>
</span><span id="__span-8-12"><a id="__codelineno-8-12" name="__codelineno-8-12" href="#__codelineno-8-12"></a><span class="kd">static</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">serialVersionUID</span><span class="o">=</span><span class="mi">13L</span><span class="p">;</span><span class="w"> </span>
</span><span id="__span-8-13"><a id="__codelineno-8-13" name="__codelineno-8-13" href="#__codelineno-8-13"></a><span class="p">...</span>
</span></code></pre></div>
<p>Cuando queremos utilizarlo, en lugar de crear una <code>Query</code> debemos crear una <code>NamedQuery</code>, de la siguiente manera:</p>
<div class="language-java highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="n">Query</span><span class="o">&lt;</span><span class="n">Alumno</span><span class="o">&gt;</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">laSesion</span><span class="p">.</span><span class="na">createNamedQuery</span><span class="p">(</span><span class="s">&quot;Repetidores&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">Alumno</span><span class="p">.</span><span class="na">class</span><span class="p">);</span>
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Alumnos repetidores: &quot;</span><span class="p">);</span>
</span><span id="__span-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a><span class="n">List</span><span class="o">&lt;</span><span class="n">Alumno</span><span class="o">&gt;</span><span class="w"> </span><span class="n">losAlumnos</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">q</span><span class="p">.</span><span class="na">list</span><span class="p">();</span>
</span><span id="__span-9-4"><a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a>
</span><span id="__span-9-5"><a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a><span class="n">q</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">laSesion</span><span class="p">.</span><span class="na">createNamedQuery</span><span class="p">(</span><span class="s">&quot;AlumnosEntre&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">Alumno</span><span class="p">.</span><span class="na">class</span><span class="p">);</span>
</span><span id="__span-9-6"><a id="__codelineno-9-6" name="__codelineno-9-6" href="#__codelineno-9-6"></a><span class="n">q</span><span class="p">.</span><span class="na">setParameter</span><span class="p">(</span><span class="s">&quot;min&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">23</span><span class="p">);</span>
</span><span id="__span-9-7"><a id="__codelineno-9-7" name="__codelineno-9-7" href="#__codelineno-9-7"></a><span class="n">q</span><span class="p">.</span><span class="na">setParameter</span><span class="p">(</span><span class="s">&quot;max&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">28</span><span class="p">);</span>
</span><span id="__span-9-8"><a id="__codelineno-9-8" name="__codelineno-9-8" href="#__codelineno-9-8"></a>
</span><span id="__span-9-9"><a id="__codelineno-9-9" name="__codelineno-9-9" href="#__codelineno-9-9"></a><span class="n">q</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">laSesion</span><span class="p">.</span><span class="na">createNamedQuery</span><span class="p">(</span><span class="s">&quot;AlumnosDescAge&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">Alumno</span><span class="p">.</span><span class="na">class</span><span class="p">);</span>
</span><span id="__span-9-10"><a id="__codelineno-9-10" name="__codelineno-9-10" href="#__codelineno-9-10"></a><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Alumnos de mayor a menor: &quot;</span><span class="p">);</span>
</span></code></pre></div>
<h2 id="54-crud">5.4. CRUD</h2>
<p>Por último, analizaremos el resto de las operaciones CRUD. Cabe destacar que estas operaciones se pueden realizar directamente sobre los objetos, por lo que se explican como complementarias más que principales.</p>
<h3 id="541-crear-create-insert">5.4.1. Crear (Create - Insert)</h3>
<p>Si queremos insertar un nuevo objeto en la base de datos, es muy fácil, como podemos recordar en las primeras secciones de esta unidad.</p>
<div class="language-java highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="n">Alumno</span><span class="w"> </span><span class="n">a</span><span class="o">=</span><span class="k">new</span><span class="w"> </span><span class="n">Alumno</span><span class="p">();</span>
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a><span class="n">a</span><span class="p">.</span><span class="na">setApellidos</span><span class="p">(</span><span class="s">&quot;Hamilton&quot;</span><span class="p">);</span>
</span><span id="__span-10-3"><a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a><span class="n">a</span><span class="p">.</span><span class="na">setNúmero</span><span class="p">(</span><span class="s">&quot;Lewis&quot;</span><span class="p">);</span>
</span><span id="__span-10-4"><a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a><span class="n">a</span><span class="p">.</span><span class="na">setEdad</span><span class="p">(</span><span class="mi">42</span><span class="p">);</span>
</span><span id="__span-10-5"><a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a><span class="n">a</span><span class="p">.</span><span class="na">setRepetidor</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>
</span><span id="__span-10-6"><a id="__codelineno-10-6" name="__codelineno-10-6" href="#__codelineno-10-6"></a>
</span><span id="__span-10-7"><a id="__codelineno-10-7" name="__codelineno-10-7" href="#__codelineno-10-7"></a><span class="n">laSesion</span><span class="p">.</span><span class="na">persist</span><span class="p">(</span><span class="n">a</span><span class="p">);</span>
</span></code></pre></div>
<p>Simplemente creamos un nuevo objeto, establecemos sus valores, mediante setters o constructor con todos los argumentos, y finalmente lo almacenamos en la base de datos con el método <code>persist</code>. Puede utilizar <code>save</code> o <code>saveOrUpdate</code> indistintamente. Puede ver algunas diferencias entre ellos <a href="https://javatute.com/hibernate/difference-between-save-and-persist-in-hibernate/">aquí</a>. Ambos ejecutan una instrucción <code>insert sql</code>.</p>
<p>Al igual que SQL, podríamos insertar en una tabla con el resultado de una consulta, como sigue:</p>
<div class="language-sql highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="k">insert</span><span class="w"> </span><span class="k">into</span><span class="w"> </span><span class="k">class</span><span class="p">(</span><span class="n">properties</span><span class="p">)</span><span class="w"> </span><span class="n">select_hql</span><span class="p">;</span>
</span></code></pre></div>
<h3 id="542-actualizacion-update">5.4.2. Actualización (Update)</h3>
<p>Para cambiar el valor de una o más propiedades de un objeto, podemos cargar el objeto de la base de datos, cambiar los valores mediante los métodos getters y después guardar los cambios.</p>
<div class="language-java highlight"><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="n">Alumno</span><span class="w"> </span><span class="n">en</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">laSesion</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="n">Alumno</span><span class="p">.</span><span class="na">class</span><span class="p">,</span><span class="w"> </span><span class="mi">7L</span><span class="p">);</span>
</span><span id="__span-12-2"><a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a><span class="n">a</span><span class="p">.</span><span class="na">setEdad</span><span class="p">(</span><span class="mi">44</span><span class="p">);</span>
</span><span id="__span-12-3"><a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a><span class="n">a</span><span class="p">.</span><span class="na">setRepetidor</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>
</span><span id="__span-12-4"><a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a>
</span><span id="__span-12-5"><a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a><span class="n">laSesion</span><span class="p">.</span><span class="na">update</span><span class="p">(</span><span class="n">a</span><span class="p">);</span>
</span><span id="__span-12-6"><a id="__codelineno-12-6" name="__codelineno-12-6" href="#__codelineno-12-6"></a><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">a</span><span class="p">);</span>
</span></code></pre></div>
<p>Si queremos establecer una actualización masiva, que afecte a varios registros en la base de datos, podríamos utilizarlo de la misma manera que en SQL:</p>
<div class="language-java highlight"><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="n">Query</span><span class="w"> </span><span class="n">q</span><span class="o">=</span><span class="n">laSesion</span><span class="p">.</span><span class="na">createQuery</span><span class="p">(</span><span class="s">&quot;Update from Alumno a siete a.edad=a.edad+1 where a.repetidor=true&quot;</span><span class="p">);</span>
</span><span id="__span-13-2"><a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a><span class="kt">int</span><span class="w"> </span><span class="n">howMany</span><span class="o">=</span><span class="n">q</span><span class="p">.</span><span class="na">executeUpdate</span><span class="p">();</span>
</span><span id="__span-13-3"><a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a>
</span><span id="__span-13-4"><a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">howMany</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;alumnos actualizados&quot;</span><span class="p">);</span>
</span></code></pre></div>
<h3 id="543-eliminacion-delete">5.4.3. Eliminación (Delete)</h3>
<p>Como en las secciones anteriores, podríamos eliminar un único objeto o conjunto de registros que cumplan una condición. En el caso de un único objeto, necesitamos cargarlo y después eliminarlo:</p>
<div class="language-java highlight"><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="n">Alumno</span><span class="w"> </span><span class="n">en</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">laSesion</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="n">Alumno</span><span class="p">.</span><span class="na">class</span><span class="p">,</span><span class="w"> </span><span class="mi">7L</span><span class="p">);</span>
</span><span id="__span-14-2"><a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a><span class="n">laSesion</span><span class="p">.</span><span class="na">delete</span><span class="p">(</span><span class="n">a</span><span class="p">);</span>
</span><span id="__span-14-3"><a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a>
</span><span id="__span-14-4"><a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">a</span><span class="p">);</span>
</span></code></pre></div>
<p>Ten en cuenta que el objeto permanece en memoria o hasta el final del método, pero cuando la sesión se confirma, el objeto pasará a estar <code>detached</code>. El estado <code>detached</code> significa que este objeto está fuera de cualquier tipo de seguimiento. No tenemos la posibilidad de guardar o actualizar ese objeto de nuevo.</p>
<p>Para realizar una eliminación masiva, al igual que SQL:</p>
<div class="language-java highlight"><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="n">Query</span><span class="w"> </span><span class="n">q</span><span class="o">=</span><span class="n">laSesion</span><span class="p">.</span><span class="na">createQuery</span><span class="p">(</span><span class="s">&quot;delete from Alumno a where a.repetidor=true&quot;</span><span class="p">);</span>
</span><span id="__span-15-2"><a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a><span class="kt">int</span><span class="w"> </span><span class="n">howMany</span><span class="o">=</span><span class="n">q</span><span class="p">.</span><span class="na">executeUpdate</span><span class="p">();</span>
</span><span id="__span-15-3"><a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a>
</span><span id="__span-15-4"><a id="__codelineno-15-4" name="__codelineno-15-4" href="#__codelineno-15-4"></a><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">howMany</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;alumnos borrados&quot;</span><span class="p">);</span>
</span></code></pre></div>
<div class="admonition tip">
<p class="admonition-title">Consejo</p>
</div>
<p>Recuerda estos consejo generales: </p>
<ul>
<li>Estas sentencias pueden contener parámetros (en sentencias que contienen la cláusula <code>where</code>). </li>
<li>El <code>where</code> es opcional, pero eliminará o actualizará todo si falta. </li>
<li>Estas consultas se ejecutan todas utilizando <code>executeUpdate()</code>, para que cambien el estado de la base de datos, y devolverá un entero con el número de filas afectadas.</li>
</ul>
<p>Tienes que prestar atención a las eliminaciones, ya que dependiendo de cómo hemos definido las relaciones (eliminaciones en cascada, dejando filas huérfanas, etc.) pueden o no ocurrir, y arrojar <code>java.sql.SQLIntegrityConstraintViolationException</code>.</p>
<p>Como comentario final en esta sección, recuerda lo que se ha dicho anteriormente: en la manipulación de objetos (eliminaciones, modificaciones, etc.) tenemos herramientas suficientes para hacerlo sin consultas HQL. Estas consultas son más adecuadas para procesar grandes volúmenes de información sin cargar esta información en nuestro programa para procesarla.</p>
<h2 id="55-apendice-estado-de-los-objetos">5.5. Apéndice, Estado de los objetos</h2>
<p>Como hemos dicho a lo largo de esta unidad, los objetos se cargan y controlan por el gestor de sesiones. Cada objeto podría tener un estado dentro de la sesión, siendo interesante conocer todas las posibilidades. En esta imagen, puede ver todos los diferentes estados y el método para cambiar el estado del objeto.</p>
<figure>
  <img alt="Image title" src="../img/ObjectStatus.png" width="700" />
<br />
<figcaption>Object Status<figcaption>
</figcaption>
</figure>
<ul>
<li><strong>transient</strong> → El objeto tiene identidad (existe en memoria), pero no tiene una identidad persistente, o clave primaria.</li>
<li><strong>persistente</strong> → El objeto ha estado marcado para ser guardado (persistido), y la identidad en memoria está relacionada con la identidad de la base de datos. Cuando cargamos un objeto de la base de datos, éste es el estado inicial.</li>
<li><strong>detached</strong> → El objeto ha sido persistido recientemente, pero este contexto está cerrado, con el método <code>detach()</code>. Las operaciones cuando está desconectado no se reflejarán en la base de datos.</li>
<li><strong>removed</strong> → El objeto ha sido marcado para ser eliminado (pero todavía no se ha efectuado). Cuando la sesión se cierre, será eliminado efectivamente, pero podemos volver a cargarlo y ponerlo en un contexto persistente.</li>
</ul>
<p>Puede obtener más información <a href="https://www.baeldung.com/hibernate-session-object-states">aquí</a>.</p>
<!--

http://www.cursohibernate.es/doku.php





-->












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../4_Relationships.es/" class="md-footer__link md-footer__link--prev" aria-label="Previous: 4. Mapeando Relaciones">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                4. Mapeando Relaciones
              </div>
            </div>
          </a>
        
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2025 Manu Romero
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://youtube.com/@ciclosformativosinfo" target="_blank" rel="noopener" title="youtube.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M23.498 6.186a3.02 3.02 0 0 0-2.122-2.136C19.505 3.545 12 3.545 12 3.545s-7.505 0-9.377.505A3.02 3.02 0 0 0 .502 6.186C0 8.07 0 12 0 12s0 3.93.502 5.814a3.02 3.02 0 0 0 2.122 2.136c1.871.505 9.376.505 9.376.505s7.505 0 9.377-.505a3.02 3.02 0 0 0 2.122-2.136C24 15.93 24 12 24 12s0-3.93-.502-5.814M9.545 15.568V8.432L15.818 12z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://bsky.app/profile/malsonvalencia.bsky.social" target="_blank" rel="noopener" title="bsky.app" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M5.202 2.857C7.954 4.922 10.913 9.11 12 11.358c1.087-2.247 4.046-6.436 6.798-8.501C20.783 1.366 24 .213 24 3.883c0 .732-.42 6.156-.667 7.037-.856 3.061-3.978 3.842-6.755 3.37 4.854.826 6.089 3.562 3.422 6.299-5.065 5.196-7.28-1.304-7.847-2.97-.104-.305-.152-.448-.153-.327 0-.121-.05.022-.153.327-.568 1.666-2.782 8.166-7.847 2.97-2.667-2.737-1.432-5.473 3.422-6.3-2.777.473-5.899-.308-6.755-3.369C.42 10.04 0 4.615 0 3.883c0-3.67 3.217-2.517 5.202-1.026"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.footer", "content.code.copy"], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
    
  </body>
</html>