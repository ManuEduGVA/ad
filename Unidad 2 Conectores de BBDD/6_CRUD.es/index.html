
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="http://sitename.example.com/Unidad%202%20Conectores%20de%20BBDD/6_CRUD.es/">
      
      
        <link rel="prev" href="../5_Metadata.es/">
      
      
        <link rel="next" href="../7_Row_to_Object.es/">
      
      
      <link rel="icon" href="../../assets/Cheste.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.22">
    
    
      
        <title>6. Statements and CRUD operations - Acceso a Datos</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.84d31ad4.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,700,700i%7CRed+Hat+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Open Sans";--md-code-font:"Red Hat Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="blue-grey" data-md-color-accent="deep-purple">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#6-statements-and-crud-operations" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Acceso a Datos" class="md-header__button md-logo" aria-label="Acceso a Datos" data-md-component="logo">
      
  <img src="../../assets/Cheste.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Acceso a Datos
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              6. Statements and CRUD operations
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="blue-grey" data-md-color-accent="deep-purple"  aria-label="Dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="deep-orange"  aria-label="Light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Acceso a Datos" class="md-nav__button md-logo" aria-label="Acceso a Datos" data-md-component="logo">
      
  <img src="../../assets/Cheste.png" alt="logo">

    </a>
    Acceso a Datos
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Inicio
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Unidad 1 Ficheros
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Unidad 1 Ficheros
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Unidad%201%20Ficheros/1_File_System.es/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    1. Sistema de archivos
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Unidad%201%20Ficheros/2_Reading_and_writing_files.es/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    2. Lectura y escritura de archivos
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Unidad%201%20Ficheros/3_XML_Files.es/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    3. Archivos XML
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Unidad%201%20Ficheros/4_JSON_Files.es/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    4. Archivos JSON
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Unidad%201%20Ficheros/5_Extra_Formats.es/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    5. Formatos extra
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Unidad%201%20Ficheros/6_Ejercicios.es/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Ejercicios sistema de archivos
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Unidad 2 Conectores de BBDD
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Unidad 2 Conectores de BBDD
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../1_Object_relational_impedance_mismatch.es/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    1. Desfase objeto-relacional
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../2_Connectors.es/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    2. Conectores
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../3_Connecting.es/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    3. Conectando a bases de datos
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../4_Resultset.es/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    4. Clase ResultSet.
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../5_Metadata.es/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    5. Metadata de la base de datos
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    6. Statements and CRUD operations
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    6. Statements and CRUD operations
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#61-create-insert" class="md-nav__link">
    <span class="md-ellipsis">
      6.1. Create (Insert)
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#62-read-select" class="md-nav__link">
    <span class="md-ellipsis">
      6.2. Read (Select)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="6.2. Read (Select)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#621-sentencias-fijas" class="md-nav__link">
    <span class="md-ellipsis">
      6.2.1. Sentencias fijas
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#622-sentencias-variables" class="md-nav__link">
    <span class="md-ellipsis">
      6.2.2. Sentencias variables
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#623-sentencias-preparadas" class="md-nav__link">
    <span class="md-ellipsis">
      6.2.3. Sentencias preparadas
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#63-actualizacion-update-y-borrado-delete" class="md-nav__link">
    <span class="md-ellipsis">
      6.3. Actualización (Update) y Borrado (Delete)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="6.3. Actualización (Update) y Borrado (Delete)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#631-ejemplo-de-borrado" class="md-nav__link">
    <span class="md-ellipsis">
      6.3.1. Ejemplo de borrado
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#632-ejemplo-de-actualizacion" class="md-nav__link">
    <span class="md-ellipsis">
      6.3.2. Ejemplo de Actualización
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#64-scripts" class="md-nav__link">
    <span class="md-ellipsis">
      6.4. Scripts
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#65-transacciones" class="md-nav__link">
    <span class="md-ellipsis">
      6.5. Transacciones
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#66-resultsets-actualizables" class="md-nav__link">
    <span class="md-ellipsis">
      6.6. ResultSets actualizables
    </span>
  </a>
  
    <nav class="md-nav" aria-label="6.6. ResultSets actualizables">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#661-movimiento-del-resultset" class="md-nav__link">
    <span class="md-ellipsis">
      6.6.1. Movimiento del ResultSet
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#662-eliminacion-de-filas-en-un-resultset" class="md-nav__link">
    <span class="md-ellipsis">
      6.6.2. Eliminación de filas en un ResultSet
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#663-actualizacion-de-filas-en-un-resultset" class="md-nav__link">
    <span class="md-ellipsis">
      6.6.3. Actualización de filas en un ResultSet
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#164-insercion-de-filas-en-un-resultset" class="md-nav__link">
    <span class="md-ellipsis">
      1.6.4. Inserción de filas en un ResultSet
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../7_Row_to_Object.es/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    7. De filas a Objetos
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../clienteSQL/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Actividad Cliente MySQL
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Unidad 3 Hibernate
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Unidad 3 Hibernate
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Unidad%203%20Hibernate/1_Mapping.es/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    1 Mapping
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Unidad%203%20Hibernate/2_Hibernate.es/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    2. Hibernate
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Unidad%203%20Hibernate/3_Entities_Beans.es/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    3. Mapeo de Entidades con JPA y Hibernate
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Unidad%203%20Hibernate/4_Relationships.es/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    4. Mapeando Relaciones
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Unidad%203%20Hibernate/5_HQL.es/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    5. Hibernate Query Language
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#61-create-insert" class="md-nav__link">
    <span class="md-ellipsis">
      6.1. Create (Insert)
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#62-read-select" class="md-nav__link">
    <span class="md-ellipsis">
      6.2. Read (Select)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="6.2. Read (Select)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#621-sentencias-fijas" class="md-nav__link">
    <span class="md-ellipsis">
      6.2.1. Sentencias fijas
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#622-sentencias-variables" class="md-nav__link">
    <span class="md-ellipsis">
      6.2.2. Sentencias variables
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#623-sentencias-preparadas" class="md-nav__link">
    <span class="md-ellipsis">
      6.2.3. Sentencias preparadas
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#63-actualizacion-update-y-borrado-delete" class="md-nav__link">
    <span class="md-ellipsis">
      6.3. Actualización (Update) y Borrado (Delete)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="6.3. Actualización (Update) y Borrado (Delete)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#631-ejemplo-de-borrado" class="md-nav__link">
    <span class="md-ellipsis">
      6.3.1. Ejemplo de borrado
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#632-ejemplo-de-actualizacion" class="md-nav__link">
    <span class="md-ellipsis">
      6.3.2. Ejemplo de Actualización
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#64-scripts" class="md-nav__link">
    <span class="md-ellipsis">
      6.4. Scripts
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#65-transacciones" class="md-nav__link">
    <span class="md-ellipsis">
      6.5. Transacciones
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#66-resultsets-actualizables" class="md-nav__link">
    <span class="md-ellipsis">
      6.6. ResultSets actualizables
    </span>
  </a>
  
    <nav class="md-nav" aria-label="6.6. ResultSets actualizables">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#661-movimiento-del-resultset" class="md-nav__link">
    <span class="md-ellipsis">
      6.6.1. Movimiento del ResultSet
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#662-eliminacion-de-filas-en-un-resultset" class="md-nav__link">
    <span class="md-ellipsis">
      6.6.2. Eliminación de filas en un ResultSet
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#663-actualizacion-de-filas-en-un-resultset" class="md-nav__link">
    <span class="md-ellipsis">
      6.6.3. Actualización de filas en un ResultSet
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#164-insercion-de-filas-en-un-resultset" class="md-nav__link">
    <span class="md-ellipsis">
      1.6.4. Inserción de filas en un ResultSet
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="6-statements-and-crud-operations">6. Statements and CRUD operations</h1>
<p>En esta sección estudiaremos el principal objetivo de trabajar con bases de datos: manipular datos. Siempre trabajaremos con la misma plantilla:</p>
<ol>
<li>Conectar a la base de datos.</li>
<li>Preparar la consulta.</li>
<li>Ejecutar la consulta.</li>
<li>Procesamiento de los datos, si es necesario.</li>
</ol>
<p>El punto 1 se ha estudiado en las secciones anteriores.</p>
<p>Para crear las consultas, deberemos utilizar las siguientes clases/interfaces:</p>
<ul>
<li><code>Statement</code> → Se utiliza de forma general y es útil cuando queremos realizar <strong>sentencias SQL estáticas</strong>, ya que no acepta parámetros. Creamos un <code>Statement</code> con el método <code>createStatement()</code> de la clase <code>Connection</code>.</li>
<li><code>PreparedStatement</code> → Se utiliza cuando queremos lanzar varias consultas y, además, se permite realizar <strong>sentencias dinámicas</strong>. Creamos un <code>PreparedStatement</code> con el método <code>prepareStatement()</code> de la clase <code>Connection</code>.</li>
<li><code>CallableStatement</code> → Se utiliza para acceder a procedimientos almacenados en la base de datos y también acepta parámetros de entrada. Creamos un <code>CallableStatement</code> con el método <code>prepareCall()</code> de la clase <code>Connection</code>.</li>
</ul>
<p>Cuando la sentencia está preparada, podemos ejecutarla con:</p>
<ul>
<li><code>executeQuery</code> → Ejecuta sentencias que <strong>esperamos que devuelvan datos</strong> (consultas SELECT). El valor de retorno de esta ejecución es, como ya supondrá, un ResultSet.</li>
<li><code>executeUpdate</code> → Ejecuta sentencias que <strong>no se espera que devuelvan datos</strong>, pero que se utilizarán para modificar la base de datos conectada (consultas INSERT, DELETE, UPDATE y CREATE TABLE).</li>
</ul>
<h2 id="61-create-insert">6.1. Create (Insert)</h2>
<p>Vamos a ver un ejemplo sencillo de declaración <code>INSERT</code>.</p>
<div class="language-java highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">ConnexionDB</span><span class="w"> </span><span class="n">conDB</span><span class="o">=</span><span class="k">new</span><span class="w"> </span><span class="n">ConnexioDB</span><span class="p">(</span><span class="s">&quot;BDJuegos&quot;</span><span class="p">);</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="n">Connection</span><span class="w"> </span><span class="n">con</span><span class="o">=</span><span class="n">conDB</span><span class="p">.</span><span class="na">getConnexio</span><span class="p">();</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="n">String</span><span class="w"> </span><span class="n">SQL</span><span class="o">=</span><span class="s">&quot;INSERT INTO Juego VALUES (1, &#39;Double Dragon&#39;, &#39;Dos hermanos gemelos expertos en artes marciales deben hacerse camino en un escenario urbano donde miembros de bandas rivales quieren dejarlos fuera de combate.&#39;, 1);&quot;</span><span class="p">;</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="n">Statement</span><span class="w"> </span><span class="n">st</span><span class="o">=</span><span class="n">con</span><span class="p">.</span><span class="na">createStatement</span><span class="p">();</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="kt">int</span><span class="w"> </span><span class="n">affectedRows</span><span class="o">=</span><span class="n">st</span><span class="p">.</span><span class="na">executeUpdate</span><span class="p">(</span><span class="n">SQL</span><span class="p">);</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">affectedRows</span><span class="o">+</span><span class="w"> </span><span class="s">&quot;row has been inserted&quot;</span><span class="p">);</span>
</span></code></pre></div>
<p>Como puede ver, es muy fácil de entender el código. Creamos una declaración vacía y después ejecutamos el SQL "per se". La ejecución devuelve el número de filas insertadas. Veremos mejores formas de insertar datos, utilizando scripts.</p>
<div class="admonition info">
<p class="admonition-title">Info</p>
</div>
<p>Este código es una versión reducida, puesto que cuando trabajamos con bases de datos pueden aparecer <code>SQLException</code>. Supongamos que el proceso de conexión ya se ha realizado.</p>
<h2 id="62-read-select">6.2. Read (Select)</h2>
<p>La lectura es el proceso más importante que realizaremos, ya que sólo con el proceso de inicio de sesión dentro de una aplicación estamos recuperando información de una base de datos. En todos los casos, debemos escribir la sentencia (SQL), ejecutarla y finalmente procesar los datos devueltos. Dependiendo de cómo preparamos la sentencia, podemos distinguir entre:</p>
<ol>
<li>Sentencias fijas</li>
<li>Sentencias variables</li>
<li>Sentencias preparadas</li>
</ol>
<p>Veremos con detalle ambos modos. Utilizaremos para ello el script <code>instituto</code>  en el siguiente <a href="../instituto.sql">enlace</a>.</p>
<h3 id="621-sentencias-fijas">6.2.1. Sentencias fijas</h3>
<p>Estas sentencias, como su nombre indica, son sentencias fijas o constantes. SQL es fija y no tiene ninguna variable.</p>
<div class="language-java highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="kn">package</span><span class="w"> </span><span class="nn">org.dam</span><span class="p">;</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="kn">import</span><span class="w"> </span><span class="nn">java.sql.Connection</span><span class="p">;</span>
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="kn">import</span><span class="w"> </span><span class="nn">java.sql.ResultSet</span><span class="p">;</span>
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a><span class="kn">import</span><span class="w"> </span><span class="nn">java.sql.SQLException</span><span class="p">;</span>
</span><span id="__span-1-6"><a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a><span class="kn">import</span><span class="w"> </span><span class="nn">java.sql.Statement</span><span class="p">;</span>
</span><span id="__span-1-7"><a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a>
</span><span id="__span-1-8"><a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a><span class="c1">//TIP To &lt;b&gt;Run&lt;/b&gt; code, press &lt;shortcut actionId=&quot;Run&quot;/&gt; or</span>
</span><span id="__span-1-9"><a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a><span class="c1">// click the &lt;icon src=&quot;AllIcons.Actions.Execute&quot;/&gt; icon in the gutter.</span>
</span><span id="__span-1-10"><a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Main</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-1-11"><a id="__codelineno-1-11" name="__codelineno-1-11" href="#__codelineno-1-11"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">SQLException</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-1-12"><a id="__codelineno-1-12" name="__codelineno-1-12" href="#__codelineno-1-12"></a>
</span><span id="__span-1-13"><a id="__codelineno-1-13" name="__codelineno-1-13" href="#__codelineno-1-13"></a><span class="w">        </span><span class="n">ConexionDB</span><span class="w"> </span><span class="n">conDB</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ConexionDB</span><span class="p">(</span><span class="s">&quot;instituto&quot;</span><span class="p">);</span>
</span><span id="__span-1-14"><a id="__codelineno-1-14" name="__codelineno-1-14" href="#__codelineno-1-14"></a><span class="w">        </span><span class="n">Connection</span><span class="w"> </span><span class="n">con</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">conDB</span><span class="p">.</span><span class="na">getConexion</span><span class="p">();</span>
</span><span id="__span-1-15"><a id="__codelineno-1-15" name="__codelineno-1-15" href="#__codelineno-1-15"></a><span class="w">        </span><span class="n">String</span><span class="w"> </span><span class="n">SQL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Select * from persona&quot;</span><span class="p">;</span>
</span><span id="__span-1-16"><a id="__codelineno-1-16" name="__codelineno-1-16" href="#__codelineno-1-16"></a><span class="w">        </span><span class="c1">// The statement</span>
</span><span id="__span-1-17"><a id="__codelineno-1-17" name="__codelineno-1-17" href="#__codelineno-1-17"></a><span class="w">        </span><span class="n">Statement</span><span class="w"> </span><span class="n">st</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">con</span><span class="p">.</span><span class="na">createStatement</span><span class="p">();</span>
</span><span id="__span-1-18"><a id="__codelineno-1-18" name="__codelineno-1-18" href="#__codelineno-1-18"></a><span class="w">        </span><span class="c1">// The execution</span>
</span><span id="__span-1-19"><a id="__codelineno-1-19" name="__codelineno-1-19" href="#__codelineno-1-19"></a><span class="w">        </span><span class="n">ResultSet</span><span class="w"> </span><span class="n">rst</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">st</span><span class="p">.</span><span class="na">executeQuery</span><span class="p">(</span><span class="n">SQL</span><span class="p">);</span>
</span><span id="__span-1-20"><a id="__codelineno-1-20" name="__codelineno-1-20" href="#__codelineno-1-20"></a>
</span><span id="__span-1-21"><a id="__codelineno-1-21" name="__codelineno-1-21" href="#__codelineno-1-21"></a><span class="w">        </span><span class="c1">// processing</span>
</span><span id="__span-1-22"><a id="__codelineno-1-22" name="__codelineno-1-22" href="#__codelineno-1-22"></a><span class="w">        </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">rst</span><span class="p">.</span><span class="na">next</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-1-23"><a id="__codelineno-1-23" name="__codelineno-1-23" href="#__codelineno-1-23"></a><span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">print</span><span class="p">(</span><span class="n">Colores</span><span class="p">.</span><span class="na">Bright_Blue</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;Person: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Colores</span><span class="p">.</span><span class="na">Reset</span><span class="p">);</span>
</span><span id="__span-1-24"><a id="__codelineno-1-24" name="__codelineno-1-24" href="#__codelineno-1-24"></a><span class="w">            </span><span class="cm">/*</span>
</span><span id="__span-1-25"><a id="__codelineno-1-25" name="__codelineno-1-25" href="#__codelineno-1-25"></a><span class="cm">            System.out.println(</span>
</span><span id="__span-1-26"><a id="__codelineno-1-26" name="__codelineno-1-26" href="#__codelineno-1-26"></a><span class="cm">            rst.getString(3)+ &quot;, &quot;+</span>
</span><span id="__span-1-27"><a id="__codelineno-1-27" name="__codelineno-1-27" href="#__codelineno-1-27"></a><span class="cm">            rst.getString(2)+ &quot; - &quot;+</span>
</span><span id="__span-1-28"><a id="__codelineno-1-28" name="__codelineno-1-28" href="#__codelineno-1-28"></a><span class="cm">            rst.getInt(4));</span>
</span><span id="__span-1-29"><a id="__codelineno-1-29" name="__codelineno-1-29" href="#__codelineno-1-29"></a><span class="cm">            */</span>
</span><span id="__span-1-30"><a id="__codelineno-1-30" name="__codelineno-1-30" href="#__codelineno-1-30"></a><span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span>
</span><span id="__span-1-31"><a id="__codelineno-1-31" name="__codelineno-1-31" href="#__codelineno-1-31"></a><span class="w">                    </span><span class="n">rst</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;apellidos&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;, &quot;</span><span class="w"> </span><span class="o">+</span>
</span><span id="__span-1-32"><a id="__codelineno-1-32" name="__codelineno-1-32" href="#__codelineno-1-32"></a><span class="w">                            </span><span class="n">rst</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;nombre&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot; - &quot;</span><span class="w"> </span><span class="o">+</span>
</span><span id="__span-1-33"><a id="__codelineno-1-33" name="__codelineno-1-33" href="#__codelineno-1-33"></a><span class="w">                            </span><span class="n">rst</span><span class="p">.</span><span class="na">getInt</span><span class="p">(</span><span class="s">&quot;edad&quot;</span><span class="p">));</span>
</span><span id="__span-1-34"><a id="__codelineno-1-34" name="__codelineno-1-34" href="#__codelineno-1-34"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-1-35"><a id="__codelineno-1-35" name="__codelineno-1-35" href="#__codelineno-1-35"></a>
</span><span id="__span-1-36"><a id="__codelineno-1-36" name="__codelineno-1-36" href="#__codelineno-1-36"></a><span class="w">        </span><span class="n">rst</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
</span><span id="__span-1-37"><a id="__codelineno-1-37" name="__codelineno-1-37" href="#__codelineno-1-37"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-1-38"><a id="__codelineno-1-38" name="__codelineno-1-38" href="#__codelineno-1-38"></a><span class="p">}</span>
</span></code></pre></div>
<p>En el procesamiento de la información, ResultSet tiene:</p>
<ul>
<li><code>type getType(int columnIndex)</code> → método sobrecargado que devuelve el tipo de datos dado, utilizando el índice de columna del ResultSet. Recuerda que la primera columna es 1 en lugar de 0. El tipo puede ser Int, String, Double, etc. si conoces el tipo. Para columnas desconocidas, puedes utilizar <code>Object</code> como tipo genérico.</li>
<li><code>type getType(String columnName)</code> → mismo que el método anterior, pero accediendo a la columna con el nombre que hemos seleccionado en la consulta o el nombre en la tabla.</li>
</ul>
<h3 id="622-sentencias-variables">6.2.2. Sentencias variables</h3>
<p>Imagina que quieres recuperar nombres que contengan la cadena <code>Ma</code> en su interior.</p>
<div class="language-sql highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="n">String</span><span class="w"> </span><span class="k">SQL</span><span class="o">=</span><span class="ss">&quot;Select * from persona where nombre like &#39;%Ma%&#39;&quot;</span><span class="p">;</span>
</span></code></pre></div>
<p>En ese caso, esta consulta está codificada directamente, y si quieres cambiar la parte del texto, debes modificar tu código. Para evitar la codificación directa, podemos escribir:</p>
<div class="language-java highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="n">ConexionDB</span><span class="w"> </span><span class="n">conDB</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ConexionDB</span><span class="p">(</span><span class="s">&quot;instituto&quot;</span><span class="p">);</span>
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="w">        </span><span class="n">Connection</span><span class="w"> </span><span class="n">con</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">conDB</span><span class="p">.</span><span class="na">getConexion</span><span class="p">();</span>
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a><span class="w">        </span><span class="c1">// hardcoded String</span>
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a><span class="w">        </span><span class="c1">// String SQL=&quot;Select * from persona where nombre like &#39;%Ma%&#39;&quot;;</span>
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a>
</span><span id="__span-3-6"><a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a><span class="w">        </span><span class="n">String</span><span class="w"> </span><span class="n">nombre</span><span class="o">=</span><span class="n">Utilidades</span><span class="p">.</span><span class="na">leerTextoC</span><span class="p">(</span><span class="s">&quot;Introduce una parte del nombre: &quot;</span><span class="p">);</span>
</span><span id="__span-3-7"><a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a><span class="w">        </span><span class="c1">// The query</span>
</span><span id="__span-3-8"><a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a><span class="w">        </span><span class="n">String</span><span class="w"> </span><span class="n">SQL</span><span class="o">=</span><span class="s">&quot;Select * from persona where nombre like &#39;%&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">nombre</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;%&#39;&quot;</span><span class="p">;</span>
</span><span id="__span-3-9"><a id="__codelineno-3-9" name="__codelineno-3-9" href="#__codelineno-3-9"></a><span class="w">        </span><span class="c1">// The statement</span>
</span><span id="__span-3-10"><a id="__codelineno-3-10" name="__codelineno-3-10" href="#__codelineno-3-10"></a><span class="w">        </span><span class="n">Statement</span><span class="w"> </span><span class="n">st</span><span class="o">=</span><span class="n">con</span><span class="p">.</span><span class="na">createStatement</span><span class="p">();</span>
</span><span id="__span-3-11"><a id="__codelineno-3-11" name="__codelineno-3-11" href="#__codelineno-3-11"></a><span class="w">        </span><span class="c1">// The execution</span>
</span><span id="__span-3-12"><a id="__codelineno-3-12" name="__codelineno-3-12" href="#__codelineno-3-12"></a><span class="w">        </span><span class="n">ResultSet</span><span class="w"> </span><span class="n">rst</span><span class="o">=</span><span class="n">st</span><span class="p">.</span><span class="na">executeQuery</span><span class="p">(</span><span class="n">SQL</span><span class="p">);</span>
</span><span id="__span-3-13"><a id="__codelineno-3-13" name="__codelineno-3-13" href="#__codelineno-3-13"></a>
</span><span id="__span-3-14"><a id="__codelineno-3-14" name="__codelineno-3-14" href="#__codelineno-3-14"></a><span class="w">        </span><span class="c1">// processing</span>
</span><span id="__span-3-15"><a id="__codelineno-3-15" name="__codelineno-3-15" href="#__codelineno-3-15"></a><span class="w">        </span><span class="k">while</span><span class="p">(</span><span class="n">rst</span><span class="p">.</span><span class="na">next</span><span class="p">()){</span>
</span><span id="__span-3-16"><a id="__codelineno-3-16" name="__codelineno-3-16" href="#__codelineno-3-16"></a><span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">print</span><span class="p">(</span><span class="n">Colores</span><span class="p">.</span><span class="na">Bright_Blue</span><span class="o">+</span><span class="w"> </span><span class="s">&quot;Personas con &quot;</span><span class="w"> </span><span class="o">+</span><span class="n">nombre</span><span class="o">+</span><span class="s">&quot;: &quot;</span><span class="o">+</span><span class="w"> </span><span class="n">Colores</span><span class="p">.</span><span class="na">Reset</span><span class="p">);</span>
</span><span id="__span-3-17"><a id="__codelineno-3-17" name="__codelineno-3-17" href="#__codelineno-3-17"></a><span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span>
</span><span id="__span-3-18"><a id="__codelineno-3-18" name="__codelineno-3-18" href="#__codelineno-3-18"></a><span class="w">                    </span><span class="n">rst</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;apellidos&quot;</span><span class="p">)</span><span class="o">+</span><span class="w"> </span><span class="s">&quot;, &quot;</span><span class="o">+</span>
</span><span id="__span-3-19"><a id="__codelineno-3-19" name="__codelineno-3-19" href="#__codelineno-3-19"></a><span class="w">                            </span><span class="n">rst</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;nombre&quot;</span><span class="p">)</span><span class="o">+</span><span class="w"> </span><span class="s">&quot; &quot;</span><span class="o">+</span>
</span><span id="__span-3-20"><a id="__codelineno-3-20" name="__codelineno-3-20" href="#__codelineno-3-20"></a><span class="w">                            </span><span class="n">rst</span><span class="p">.</span><span class="na">getInt</span><span class="p">(</span><span class="s">&quot;edad&quot;</span><span class="p">));</span>
</span><span id="__span-3-21"><a id="__codelineno-3-21" name="__codelineno-3-21" href="#__codelineno-3-21"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-3-22"><a id="__codelineno-3-22" name="__codelineno-3-22" href="#__codelineno-3-22"></a>
</span><span id="__span-3-23"><a id="__codelineno-3-23" name="__codelineno-3-23" href="#__codelineno-3-23"></a><span class="w">        </span><span class="n">rst</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
</span><span id="__span-3-24"><a id="__codelineno-3-24" name="__codelineno-3-24" href="#__codelineno-3-24"></a><span class="w">    </span><span class="p">}</span>
</span></code></pre></div>
<p>Como podemos ver, los datos están ahora en variables, pero la construcción de SQL es más compleja. Hay que tener en cuenta que los textos deben estar entre comillas y los números no, lo que facilita cometer errores. Pero puede ser peor, este tipo de código puede incurrir en problemas de inyección SQL, como vemos en el siguiente ejemplo:</p>
<div class="language-java highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="w">        </span><span class="n">ConexionDB</span><span class="w"> </span><span class="n">conDB</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ConexionDB</span><span class="p">(</span><span class="s">&quot;instituto&quot;</span><span class="p">);</span>
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="w">        </span><span class="n">Connection</span><span class="w"> </span><span class="n">con</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">conDB</span><span class="p">.</span><span class="na">getConexion</span><span class="p">();</span>
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a><span class="w">        </span><span class="c1">// hardcoded String</span>
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a><span class="w">        </span><span class="n">String</span><span class="w"> </span><span class="n">id_persona</span><span class="o">=</span><span class="n">Utilidades</span><span class="p">.</span><span class="na">leerTextoC</span><span class="p">(</span><span class="s">&quot;Dame el id: &quot;</span><span class="p">);</span>
</span><span id="__span-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a><span class="w">        </span><span class="c1">// The query</span>
</span><span id="__span-4-6"><a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a><span class="w">        </span><span class="n">String</span><span class="w"> </span><span class="n">SQL</span><span class="o">=</span><span class="s">&quot;Select * from persona where id_persona =&quot;</span><span class="o">+</span><span class="n">id_persona</span><span class="p">;</span>
</span><span id="__span-4-7"><a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a><span class="w">        </span><span class="c1">// The statement</span>
</span><span id="__span-4-8"><a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a><span class="w">        </span><span class="n">Statement</span><span class="w"> </span><span class="n">st</span><span class="o">=</span><span class="n">con</span><span class="p">.</span><span class="na">createStatement</span><span class="p">();</span>
</span><span id="__span-4-9"><a id="__codelineno-4-9" name="__codelineno-4-9" href="#__codelineno-4-9"></a><span class="w">        </span><span class="c1">// The execution</span>
</span><span id="__span-4-10"><a id="__codelineno-4-10" name="__codelineno-4-10" href="#__codelineno-4-10"></a><span class="w">        </span><span class="n">ResultSet</span><span class="w"> </span><span class="n">rst</span><span class="o">=</span><span class="n">st</span><span class="p">.</span><span class="na">executeQuery</span><span class="p">(</span><span class="n">SQL</span><span class="p">);</span>
</span><span id="__span-4-11"><a id="__codelineno-4-11" name="__codelineno-4-11" href="#__codelineno-4-11"></a>
</span><span id="__span-4-12"><a id="__codelineno-4-12" name="__codelineno-4-12" href="#__codelineno-4-12"></a><span class="w">        </span><span class="c1">// processing</span>
</span><span id="__span-4-13"><a id="__codelineno-4-13" name="__codelineno-4-13" href="#__codelineno-4-13"></a><span class="w">        </span><span class="k">while</span><span class="p">(</span><span class="n">rst</span><span class="p">.</span><span class="na">next</span><span class="p">()){</span>
</span><span id="__span-4-14"><a id="__codelineno-4-14" name="__codelineno-4-14" href="#__codelineno-4-14"></a><span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">print</span><span class="p">(</span><span class="n">Colores</span><span class="p">.</span><span class="na">Bright_Blue</span><span class="o">+</span><span class="w"> </span><span class="s">&quot;Personas con &quot;</span><span class="w"> </span><span class="o">+</span><span class="n">id_persona</span><span class="o">+</span><span class="s">&quot;: &quot;</span><span class="o">+</span><span class="w"> </span><span class="n">Colores</span><span class="p">.</span><span class="na">Reset</span><span class="p">);</span>
</span><span id="__span-4-15"><a id="__codelineno-4-15" name="__codelineno-4-15" href="#__codelineno-4-15"></a><span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span>
</span><span id="__span-4-16"><a id="__codelineno-4-16" name="__codelineno-4-16" href="#__codelineno-4-16"></a><span class="w">                    </span><span class="n">rst</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;apellidos&quot;</span><span class="p">)</span><span class="o">+</span><span class="w"> </span><span class="s">&quot;, &quot;</span><span class="o">+</span>
</span><span id="__span-4-17"><a id="__codelineno-4-17" name="__codelineno-4-17" href="#__codelineno-4-17"></a><span class="w">                            </span><span class="n">rst</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;nombre&quot;</span><span class="p">)</span><span class="o">+</span><span class="w"> </span><span class="s">&quot; &quot;</span><span class="o">+</span>
</span><span id="__span-4-18"><a id="__codelineno-4-18" name="__codelineno-4-18" href="#__codelineno-4-18"></a><span class="w">                            </span><span class="n">rst</span><span class="p">.</span><span class="na">getInt</span><span class="p">(</span><span class="s">&quot;edad&quot;</span><span class="p">));</span>
</span><span id="__span-4-19"><a id="__codelineno-4-19" name="__codelineno-4-19" href="#__codelineno-4-19"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-4-20"><a id="__codelineno-4-20" name="__codelineno-4-20" href="#__codelineno-4-20"></a>
</span><span id="__span-4-21"><a id="__codelineno-4-21" name="__codelineno-4-21" href="#__codelineno-4-21"></a><span class="w">        </span><span class="n">rst</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
</span><span id="__span-4-22"><a id="__codelineno-4-22" name="__codelineno-4-22" href="#__codelineno-4-22"></a><span class="w">    </span><span class="p">}</span>
</span></code></pre></div>
<ul>
<li>Si el usuario introduce <code>4</code> → Se mostrará las persona con ID igual a 4</li>
<li>Si el usuario introduce <code>4 or 1</code> → Se mostrarán todas las personas</li>
</ul>
<p>Debe evitarse este tipo de consultas en las declaraciones de validación de usuario, para las que utilizaremos las sentencias preparadas y, obviamente, ser muy cautelosos en la verificación de las entradas.</p>
<h3 id="623-sentencias-preparadas">6.2.3. Sentencias preparadas</h3>
<p>Para evitar el problema de la inyección SQL, siempre que tengamos parámetros en nuestra consulta, utilizaremos sentencias preparadas. En las sentencias preparadas, donde debemos utilizar un <strong>marcador</strong>, en lugar de componerla con concatenaciones dentro de la cadena, le indicaremos con un interrogante (<code>?</code>), un carácter llamado <strong>placeholder</strong>.</p>
<p>A continuación, deberemos asignar valores a estos placeholders, utilizando los métodos <code>setType(int pos)</code> donde <code>Type</code> es el tipo de datos que asignaremos y <code>pos</code> es la posición del placeholder, empezando por <code>1</code>. Veremos el ejemplo:</p>
<div class="language-java highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="w">        </span><span class="n">ConexionDB</span><span class="w"> </span><span class="n">conDB</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ConexionDB</span><span class="p">(</span><span class="s">&quot;instituto&quot;</span><span class="p">);</span>
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="w">        </span><span class="n">Connection</span><span class="w"> </span><span class="n">con</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">conDB</span><span class="p">.</span><span class="na">getConexion</span><span class="p">();</span>
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a><span class="w">        </span><span class="c1">// hardcoded String</span>
</span><span id="__span-5-4"><a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a><span class="w">        </span><span class="n">String</span><span class="w"> </span><span class="n">id_persona</span><span class="o">=</span><span class="n">Utilidades</span><span class="p">.</span><span class="na">leerTextoC</span><span class="p">(</span><span class="s">&quot;Dame el id: &quot;</span><span class="p">);</span>
</span><span id="__span-5-5"><a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a><span class="w">        </span><span class="c1">// The query</span>
</span><span id="__span-5-6"><a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a><span class="w">        </span><span class="n">String</span><span class="w"> </span><span class="n">SQL</span><span class="o">=</span><span class="s">&quot;Select * from persona where id_persona = ?&quot;</span><span class="p">;</span>
</span><span id="__span-5-7"><a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a>
</span><span id="__span-5-8"><a id="__codelineno-5-8" name="__codelineno-5-8" href="#__codelineno-5-8"></a><span class="w">        </span><span class="c1">// The statement</span>
</span><span id="__span-5-9"><a id="__codelineno-5-9" name="__codelineno-5-9" href="#__codelineno-5-9"></a><span class="w">        </span><span class="n">PreparedStatement</span><span class="w"> </span><span class="n">pst</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">con</span><span class="p">.</span><span class="na">prepareStatement</span><span class="p">(</span><span class="n">SQL</span><span class="p">);</span>
</span><span id="__span-5-10"><a id="__codelineno-5-10" name="__codelineno-5-10" href="#__codelineno-5-10"></a>
</span><span id="__span-5-11"><a id="__codelineno-5-11" name="__codelineno-5-11" href="#__codelineno-5-11"></a><span class="w">        </span><span class="n">pst</span><span class="p">.</span><span class="na">setString</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">id_persona</span><span class="p">);</span>
</span><span id="__span-5-12"><a id="__codelineno-5-12" name="__codelineno-5-12" href="#__codelineno-5-12"></a>
</span><span id="__span-5-13"><a id="__codelineno-5-13" name="__codelineno-5-13" href="#__codelineno-5-13"></a><span class="w">        </span><span class="c1">// The execution</span>
</span><span id="__span-5-14"><a id="__codelineno-5-14" name="__codelineno-5-14" href="#__codelineno-5-14"></a><span class="w">        </span><span class="n">ResultSet</span><span class="w"> </span><span class="n">rst</span><span class="o">=</span><span class="n">pst</span><span class="p">.</span><span class="na">executeQuery</span><span class="p">();</span>
</span><span id="__span-5-15"><a id="__codelineno-5-15" name="__codelineno-5-15" href="#__codelineno-5-15"></a>
</span><span id="__span-5-16"><a id="__codelineno-5-16" name="__codelineno-5-16" href="#__codelineno-5-16"></a><span class="w">        </span><span class="c1">// processing</span>
</span><span id="__span-5-17"><a id="__codelineno-5-17" name="__codelineno-5-17" href="#__codelineno-5-17"></a><span class="w">        </span><span class="k">while</span><span class="p">(</span><span class="n">rst</span><span class="p">.</span><span class="na">next</span><span class="p">()){</span>
</span><span id="__span-5-18"><a id="__codelineno-5-18" name="__codelineno-5-18" href="#__codelineno-5-18"></a><span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">print</span><span class="p">(</span><span class="n">Colores</span><span class="p">.</span><span class="na">Bright_Blue</span><span class="o">+</span><span class="w"> </span><span class="s">&quot;Personas con &quot;</span><span class="w"> </span><span class="o">+</span><span class="n">id_persona</span><span class="o">+</span><span class="s">&quot;: &quot;</span><span class="o">+</span><span class="w"> </span><span class="n">Colores</span><span class="p">.</span><span class="na">Reset</span><span class="p">);</span>
</span><span id="__span-5-19"><a id="__codelineno-5-19" name="__codelineno-5-19" href="#__codelineno-5-19"></a><span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span>
</span><span id="__span-5-20"><a id="__codelineno-5-20" name="__codelineno-5-20" href="#__codelineno-5-20"></a><span class="w">                    </span><span class="n">rst</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;apellidos&quot;</span><span class="p">)</span><span class="o">+</span><span class="w"> </span><span class="s">&quot;, &quot;</span><span class="o">+</span>
</span><span id="__span-5-21"><a id="__codelineno-5-21" name="__codelineno-5-21" href="#__codelineno-5-21"></a><span class="w">                            </span><span class="n">rst</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;nombre&quot;</span><span class="p">)</span><span class="o">+</span><span class="w"> </span><span class="s">&quot; &quot;</span><span class="o">+</span>
</span><span id="__span-5-22"><a id="__codelineno-5-22" name="__codelineno-5-22" href="#__codelineno-5-22"></a><span class="w">                            </span><span class="n">rst</span><span class="p">.</span><span class="na">getInt</span><span class="p">(</span><span class="s">&quot;edad&quot;</span><span class="p">));</span>
</span><span id="__span-5-23"><a id="__codelineno-5-23" name="__codelineno-5-23" href="#__codelineno-5-23"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-5-24"><a id="__codelineno-5-24" name="__codelineno-5-24" href="#__codelineno-5-24"></a>
</span><span id="__span-5-25"><a id="__codelineno-5-25" name="__codelineno-5-25" href="#__codelineno-5-25"></a><span class="w">        </span><span class="n">rst</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
</span></code></pre></div>
<div class="admonition tip">
<p class="admonition-title">Consejo</p>
</div>
<p>Puedes combinar ResultSet con ResultSetMetaData para obtener los nombres de las columnas y tipos de datos almacenados en la base de datos.</p>
<h2 id="63-actualizacion-update-y-borrado-delete">6.3. Actualización (Update) y Borrado (Delete)</h2>
<p>La actualización y borrado de una fila se consideran como actualizaciones de la base de datos, ya que modifican el estado de la base de datos. De hecho, también consideramos la inserción como una actualización de la base de datos. Ambas tareas se incluyen en el método <code>executeUpdate()</code>. Vamos a estudiarlo a través de ejemplos:</p>
<h3 id="631-ejemplo-de-borrado">6.3.1. Ejemplo de borrado</h3>
<p>Vamos a borrar filas de una mesa de personas entre las edades dadas:</p>
<div class="language-java highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="w">        </span><span class="n">ConexionDB</span><span class="w"> </span><span class="n">conDB</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ConexionDB</span><span class="p">(</span><span class="s">&quot;instituto&quot;</span><span class="p">);</span>
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a><span class="w">        </span><span class="n">Connection</span><span class="w"> </span><span class="n">con</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">conDB</span><span class="p">.</span><span class="na">getConexion</span><span class="p">();</span>
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a><span class="w">        </span><span class="c1">// hardcoded String</span>
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a><span class="w">        </span><span class="c1">// give the age&#39;s bounds</span>
</span><span id="__span-6-5"><a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a><span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">minEdad</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Utilidades</span><span class="p">.</span><span class="na">leerEnteroC</span><span class="p">(</span><span class="s">&quot;Dame la edad mínima: &quot;</span><span class="p">);</span>
</span><span id="__span-6-6"><a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a><span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">maxEdad</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Utilidades</span><span class="p">.</span><span class="na">leerEnteroC</span><span class="p">(</span><span class="s">&quot;Dame la edad máxima: &quot;</span><span class="p">);</span>
</span><span id="__span-6-7"><a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a><span class="w">        </span><span class="c1">// The query</span>
</span><span id="__span-6-8"><a id="__codelineno-6-8" name="__codelineno-6-8" href="#__codelineno-6-8"></a><span class="w">        </span><span class="n">String</span><span class="w"> </span><span class="n">SQL</span><span class="o">=</span><span class="s">&quot;Delete from persona where edad between ? and ?&quot;</span><span class="p">;</span>
</span><span id="__span-6-9"><a id="__codelineno-6-9" name="__codelineno-6-9" href="#__codelineno-6-9"></a>
</span><span id="__span-6-10"><a id="__codelineno-6-10" name="__codelineno-6-10" href="#__codelineno-6-10"></a><span class="w">        </span><span class="c1">// The statement</span>
</span><span id="__span-6-11"><a id="__codelineno-6-11" name="__codelineno-6-11" href="#__codelineno-6-11"></a><span class="w">        </span><span class="n">PreparedStatement</span><span class="w"> </span><span class="n">pst</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">con</span><span class="p">.</span><span class="na">prepareStatement</span><span class="p">(</span><span class="n">SQL</span><span class="p">);</span>
</span><span id="__span-6-12"><a id="__codelineno-6-12" name="__codelineno-6-12" href="#__codelineno-6-12"></a>
</span><span id="__span-6-13"><a id="__codelineno-6-13" name="__codelineno-6-13" href="#__codelineno-6-13"></a><span class="w">        </span><span class="n">pst</span><span class="p">.</span><span class="na">setInt</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">minEdad</span><span class="p">);</span>
</span><span id="__span-6-14"><a id="__codelineno-6-14" name="__codelineno-6-14" href="#__codelineno-6-14"></a><span class="w">        </span><span class="n">pst</span><span class="p">.</span><span class="na">setInt</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">maxEdad</span><span class="p">);</span>
</span><span id="__span-6-15"><a id="__codelineno-6-15" name="__codelineno-6-15" href="#__codelineno-6-15"></a>
</span><span id="__span-6-16"><a id="__codelineno-6-16" name="__codelineno-6-16" href="#__codelineno-6-16"></a><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">pst</span><span class="p">);</span>
</span><span id="__span-6-17"><a id="__codelineno-6-17" name="__codelineno-6-17" href="#__codelineno-6-17"></a><span class="w">        </span><span class="c1">// The execution</span>
</span><span id="__span-6-18"><a id="__codelineno-6-18" name="__codelineno-6-18" href="#__codelineno-6-18"></a><span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">deletedRows</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pst</span><span class="p">.</span><span class="na">executeUpdate</span><span class="p">();</span>
</span><span id="__span-6-19"><a id="__codelineno-6-19" name="__codelineno-6-19" href="#__codelineno-6-19"></a>
</span><span id="__span-6-20"><a id="__codelineno-6-20" name="__codelineno-6-20" href="#__codelineno-6-20"></a><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">deletedRows</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot; han sido eliminadas&quot;</span><span class="p">);</span>
</span><span id="__span-6-21"><a id="__codelineno-6-21" name="__codelineno-6-21" href="#__codelineno-6-21"></a>
</span><span id="__span-6-22"><a id="__codelineno-6-22" name="__codelineno-6-22" href="#__codelineno-6-22"></a><span class="w">        </span><span class="n">pst</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
</span></code></pre></div>
<div class="admonition warning">
<p class="admonition-title">Peligro</p>
</div>
<p>Eliminar datos es una operación muy delicada. Cuida de: </p>
<ul>
<li>No olvides la cláusula <code>WHERE</code> cuando eliminas, ya que eliminarás todos los datos de la tabla. </li>
<li>Si quieres eliminar toda la tabla, incluyendo la estructura (definición + tabla), debes utilizar <code>DROP TABLE</code> en lugar de <code>DELETE</code>. </li>
<li>Si intentas eliminar una fila que está referenciada por una clave externa, obtendrás la excepción <code>SQLIntegrityConstraintViolationException</code> y un mensaje como <em>No se puede eliminar o actualizar una fila padre: falla una restricción de clave externa</em>.</li>
</ul>
<h3 id="632-ejemplo-de-actualizacion">6.3.2. Ejemplo de Actualización</h3>
<p>Vamos a añadir años a las personas con el ID dado:</p>
<div class="language-java highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="w">        </span><span class="n">ConexionDB</span><span class="w"> </span><span class="n">conDB</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ConexionDB</span><span class="p">(</span><span class="s">&quot;instituto&quot;</span><span class="p">);</span>
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a><span class="w">        </span><span class="n">Connection</span><span class="w"> </span><span class="n">con</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">conDB</span><span class="p">.</span><span class="na">getConexion</span><span class="p">();</span>
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a><span class="w">        </span><span class="c1">// hardcoded String</span>
</span><span id="__span-7-4"><a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a><span class="w">        </span><span class="c1">// give the age&#39;s bounds</span>
</span><span id="__span-7-5"><a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a><span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">difEdad</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Utilidades</span><span class="p">.</span><span class="na">leerEnteroC</span><span class="p">(</span><span class="s">&quot;Dame el número de años: &quot;</span><span class="p">);</span>
</span><span id="__span-7-6"><a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a><span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">idMin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Utilidades</span><span class="p">.</span><span class="na">leerEnteroC</span><span class="p">(</span><span class="s">&quot;Dame el id mínimo: &quot;</span><span class="p">);</span>
</span><span id="__span-7-7"><a id="__codelineno-7-7" name="__codelineno-7-7" href="#__codelineno-7-7"></a><span class="w">        </span><span class="c1">// The query</span>
</span><span id="__span-7-8"><a id="__codelineno-7-8" name="__codelineno-7-8" href="#__codelineno-7-8"></a><span class="w">        </span><span class="n">String</span><span class="w"> </span><span class="n">SQL</span><span class="o">=</span><span class="s">&quot;Update persona set edad=edad+ ? where id_persona&gt; ?&quot;</span><span class="p">;</span>
</span><span id="__span-7-9"><a id="__codelineno-7-9" name="__codelineno-7-9" href="#__codelineno-7-9"></a>
</span><span id="__span-7-10"><a id="__codelineno-7-10" name="__codelineno-7-10" href="#__codelineno-7-10"></a><span class="w">        </span><span class="c1">// The statement</span>
</span><span id="__span-7-11"><a id="__codelineno-7-11" name="__codelineno-7-11" href="#__codelineno-7-11"></a><span class="w">        </span><span class="n">PreparedStatement</span><span class="w"> </span><span class="n">pst</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">con</span><span class="p">.</span><span class="na">prepareStatement</span><span class="p">(</span><span class="n">SQL</span><span class="p">);</span>
</span><span id="__span-7-12"><a id="__codelineno-7-12" name="__codelineno-7-12" href="#__codelineno-7-12"></a>
</span><span id="__span-7-13"><a id="__codelineno-7-13" name="__codelineno-7-13" href="#__codelineno-7-13"></a><span class="w">        </span><span class="n">pst</span><span class="p">.</span><span class="na">setInt</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">difEdad</span><span class="p">);</span>
</span><span id="__span-7-14"><a id="__codelineno-7-14" name="__codelineno-7-14" href="#__codelineno-7-14"></a><span class="w">        </span><span class="n">pst</span><span class="p">.</span><span class="na">setInt</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">idMin</span><span class="p">);</span>
</span><span id="__span-7-15"><a id="__codelineno-7-15" name="__codelineno-7-15" href="#__codelineno-7-15"></a>
</span><span id="__span-7-16"><a id="__codelineno-7-16" name="__codelineno-7-16" href="#__codelineno-7-16"></a><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">pst</span><span class="p">);</span>
</span><span id="__span-7-17"><a id="__codelineno-7-17" name="__codelineno-7-17" href="#__codelineno-7-17"></a><span class="w">        </span><span class="c1">// The execution</span>
</span><span id="__span-7-18"><a id="__codelineno-7-18" name="__codelineno-7-18" href="#__codelineno-7-18"></a><span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">updatedRows</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pst</span><span class="p">.</span><span class="na">executeUpdate</span><span class="p">();</span>
</span><span id="__span-7-19"><a id="__codelineno-7-19" name="__codelineno-7-19" href="#__codelineno-7-19"></a>
</span><span id="__span-7-20"><a id="__codelineno-7-20" name="__codelineno-7-20" href="#__codelineno-7-20"></a><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">updatedRows</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot; han sido actualizadas&quot;</span><span class="p">);</span>
</span><span id="__span-7-21"><a id="__codelineno-7-21" name="__codelineno-7-21" href="#__codelineno-7-21"></a>
</span><span id="__span-7-22"><a id="__codelineno-7-22" name="__codelineno-7-22" href="#__codelineno-7-22"></a><span class="w">        </span><span class="n">pst</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
</span></code></pre></div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
</div>
<p>Recuerda que: </p>
<ul>
<li>La cláusula <code>UPDATE</code> no necesita <code>FROM</code> para que indiquemos directamente el nombre de la tabla. </li>
<li>Aparece la cláusula <code>SET</code>, con pares <code>campo=valor_actualizado</code>, para asignar el nuevo valor a los campos seleccionados. </li>
<li>Si olvidamos la cláusula <code>FROM</code>, se actualizarán todas las filas.</li>
</ul>
<h2 id="64-scripts">6.4. Scripts</h2>
<p>Un script, que normalmente se ha creado en un archivo externo, es un conjunto de instrucciones SQL ejecutadas en orden de arriba abajo. Podemos tomar como estrategia leer el archivo línea por línea y ejecutarlo una por una, pero JDBC permite ejecutar un conjunto de instrucciones en bloque. Para ello, lo primero que debemos hacer es habilitar múltiples ejecuciones añadiendo un parámetro a la conexión, que es <code>allowMultiQueries=true</code>.</p>
<p>A continuación, debemos cargar el archivo y componer una cadena con todo el script. Para normalizarlo y hacerlo totalmente portátil, debemos tener cuidado con los saltos de línea, ya que dependiendo del sistema es una combinación <code>\n</code> o <code>\r\n</code>. Podemos leer línea por línea y guardarlo en un <code>StringBuilder</code>, añadiendo <code>System.getProperty("line.separator")</code> o <code>System.lineSeparator()</code>como separadores.</p>
<p>Después sólo necesitaremos crear una declaración con esta cadena y ejecutarla con <code>executeUpdate()</code>. Lo veremos a continuación:</p>
<div class="language-java highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="n">ConexionDB</span><span class="w"> </span><span class="n">conDB</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ConexionDB</span><span class="p">(</span><span class="s">&quot;instituto&quot;</span><span class="p">);</span>
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a>
</span><span id="__span-8-3"><a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a><span class="w">        </span><span class="n">Connection</span><span class="w"> </span><span class="n">con</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">conDB</span><span class="p">.</span><span class="na">getConexion</span><span class="p">();</span>
</span><span id="__span-8-4"><a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a>
</span><span id="__span-8-5"><a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a><span class="w">        </span><span class="n">File</span><span class="w"> </span><span class="n">script</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">File</span><span class="p">(</span><span class="s">&quot;EsquemaCine.sql&quot;</span><span class="p">);</span>
</span><span id="__span-8-6"><a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a>
</span><span id="__span-8-7"><a id="__codelineno-8-7" name="__codelineno-8-7" href="#__codelineno-8-7"></a><span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">(</span><span class="n">BufferedReader</span><span class="w"> </span><span class="n">bfr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">BufferedReader</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">FileReader</span><span class="p">(</span><span class="n">script</span><span class="p">)))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-8-8"><a id="__codelineno-8-8" name="__codelineno-8-8" href="#__codelineno-8-8"></a>
</span><span id="__span-8-9"><a id="__codelineno-8-9" name="__codelineno-8-9" href="#__codelineno-8-9"></a><span class="w">            </span><span class="n">StringBuilder</span><span class="w"> </span><span class="n">sb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">StringBuilder</span><span class="p">();</span>
</span><span id="__span-8-10"><a id="__codelineno-8-10" name="__codelineno-8-10" href="#__codelineno-8-10"></a><span class="w">            </span><span class="n">String</span><span class="w"> </span><span class="n">linea</span><span class="p">;</span>
</span><span id="__span-8-11"><a id="__codelineno-8-11" name="__codelineno-8-11" href="#__codelineno-8-11"></a>
</span><span id="__span-8-12"><a id="__codelineno-8-12" name="__codelineno-8-12" href="#__codelineno-8-12"></a><span class="w">            </span><span class="k">while</span><span class="w"> </span><span class="p">((</span><span class="n">linea</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bfr</span><span class="p">.</span><span class="na">readLine</span><span class="p">())</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-8-13"><a id="__codelineno-8-13" name="__codelineno-8-13" href="#__codelineno-8-13"></a><span class="w">                </span><span class="c1">// Elimina los comentarios y espacios en blanco</span>
</span><span id="__span-8-14"><a id="__codelineno-8-14" name="__codelineno-8-14" href="#__codelineno-8-14"></a><span class="w">                </span><span class="n">linea</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">linea</span><span class="p">.</span><span class="na">trim</span><span class="p">();</span>
</span><span id="__span-8-15"><a id="__codelineno-8-15" name="__codelineno-8-15" href="#__codelineno-8-15"></a><span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">linea</span><span class="p">.</span><span class="na">isEmpty</span><span class="p">()</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">linea</span><span class="p">.</span><span class="na">startsWith</span><span class="p">(</span><span class="s">&quot;--&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">linea</span><span class="p">.</span><span class="na">startsWith</span><span class="p">(</span><span class="s">&quot;#&quot;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-8-16"><a id="__codelineno-8-16" name="__codelineno-8-16" href="#__codelineno-8-16"></a><span class="w">                    </span><span class="k">continue</span><span class="p">;</span><span class="w"> </span><span class="c1">// Omite líneas vacías y comentarios</span>
</span><span id="__span-8-17"><a id="__codelineno-8-17" name="__codelineno-8-17" href="#__codelineno-8-17"></a><span class="w">                </span><span class="p">}</span>
</span><span id="__span-8-18"><a id="__codelineno-8-18" name="__codelineno-8-18" href="#__codelineno-8-18"></a>
</span><span id="__span-8-19"><a id="__codelineno-8-19" name="__codelineno-8-19" href="#__codelineno-8-19"></a><span class="w">                </span><span class="n">sb</span><span class="p">.</span><span class="na">append</span><span class="p">(</span><span class="n">linea</span><span class="p">);</span>
</span><span id="__span-8-20"><a id="__codelineno-8-20" name="__codelineno-8-20" href="#__codelineno-8-20"></a>
</span><span id="__span-8-21"><a id="__codelineno-8-21" name="__codelineno-8-21" href="#__codelineno-8-21"></a><span class="w">                </span><span class="c1">// Si la línea termina en &#39;;&#39;, es el final de una sentencia y deberemos ejecutar esta.</span>
</span><span id="__span-8-22"><a id="__codelineno-8-22" name="__codelineno-8-22" href="#__codelineno-8-22"></a><span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">linea</span><span class="p">.</span><span class="na">endsWith</span><span class="p">(</span><span class="s">&quot;;&quot;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-8-23"><a id="__codelineno-8-23" name="__codelineno-8-23" href="#__codelineno-8-23"></a><span class="w">                    </span><span class="n">String</span><span class="w"> </span><span class="n">query</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sb</span><span class="p">.</span><span class="na">toString</span><span class="p">();</span>
</span><span id="__span-8-24"><a id="__codelineno-8-24" name="__codelineno-8-24" href="#__codelineno-8-24"></a><span class="w">                    </span><span class="k">try</span><span class="w"> </span><span class="p">(</span><span class="n">Statement</span><span class="w"> </span><span class="n">stm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">con</span><span class="p">.</span><span class="na">createStatement</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-8-25"><a id="__codelineno-8-25" name="__codelineno-8-25" href="#__codelineno-8-25"></a><span class="w">                        </span><span class="n">stm</span><span class="p">.</span><span class="na">execute</span><span class="p">(</span><span class="n">query</span><span class="p">);</span>
</span><span id="__span-8-26"><a id="__codelineno-8-26" name="__codelineno-8-26" href="#__codelineno-8-26"></a><span class="w">                    </span><span class="p">}</span>
</span><span id="__span-8-27"><a id="__codelineno-8-27" name="__codelineno-8-27" href="#__codelineno-8-27"></a><span class="w">                 </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">SQLException</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-8-28"><a id="__codelineno-8-28" name="__codelineno-8-28" href="#__codelineno-8-28"></a><span class="w">                     </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Error SQL ejecutando el script: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="na">getMessage</span><span class="p">());</span>
</span><span id="__span-8-29"><a id="__codelineno-8-29" name="__codelineno-8-29" href="#__codelineno-8-29"></a><span class="w">                 </span><span class="p">}</span>
</span><span id="__span-8-30"><a id="__codelineno-8-30" name="__codelineno-8-30" href="#__codelineno-8-30"></a><span class="w">                    </span><span class="c1">// Reinicia el StringBuilder para la próxima sentencia</span>
</span><span id="__span-8-31"><a id="__codelineno-8-31" name="__codelineno-8-31" href="#__codelineno-8-31"></a><span class="w">                    </span><span class="n">sb</span><span class="p">.</span><span class="na">setLength</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span><span id="__span-8-32"><a id="__codelineno-8-32" name="__codelineno-8-32" href="#__codelineno-8-32"></a>
</span><span id="__span-8-33"><a id="__codelineno-8-33" name="__codelineno-8-33" href="#__codelineno-8-33"></a><span class="w">                </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-8-34"><a id="__codelineno-8-34" name="__codelineno-8-34" href="#__codelineno-8-34"></a><span class="w">                    </span><span class="c1">// Si no, añade un espacio para separar partes de la misma sentencia</span>
</span><span id="__span-8-35"><a id="__codelineno-8-35" name="__codelineno-8-35" href="#__codelineno-8-35"></a><span class="w">                    </span><span class="n">sb</span><span class="p">.</span><span class="na">append</span><span class="p">(</span><span class="s">&quot; &quot;</span><span class="p">);</span>
</span><span id="__span-8-36"><a id="__codelineno-8-36" name="__codelineno-8-36" href="#__codelineno-8-36"></a><span class="w">                </span><span class="p">}</span>
</span><span id="__span-8-37"><a id="__codelineno-8-37" name="__codelineno-8-37" href="#__codelineno-8-37"></a>
</span><span id="__span-8-38"><a id="__codelineno-8-38" name="__codelineno-8-38" href="#__codelineno-8-38"></a><span class="w">            </span><span class="p">}</span>
</span><span id="__span-8-39"><a id="__codelineno-8-39" name="__codelineno-8-39" href="#__codelineno-8-39"></a><span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Script ejecutado correctamente.&quot;</span><span class="p">);</span>
</span><span id="__span-8-40"><a id="__codelineno-8-40" name="__codelineno-8-40" href="#__codelineno-8-40"></a>
</span><span id="__span-8-41"><a id="__codelineno-8-41" name="__codelineno-8-41" href="#__codelineno-8-41"></a><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">IOException</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-8-42"><a id="__codelineno-8-42" name="__codelineno-8-42" href="#__codelineno-8-42"></a><span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Error de I/O al leer el script: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="na">getMessage</span><span class="p">());</span>
</span><span id="__span-8-43"><a id="__codelineno-8-43" name="__codelineno-8-43" href="#__codelineno-8-43"></a><span class="w">        </span><span class="p">}</span>
</span></code></pre></div>
<div class="admonition tip">
<p class="admonition-title">Consejo</p>
</div>
<p>¿Recuerdas las clases <code>Files</code> y <code>Paths</code>? Reescribe el último ejemplo para obtener un código más limpio.</p>
<h2 id="65-transacciones">6.5. Transacciones</h2>
<p>Si queremos proteger la integridad de los datos, así como evitar situaciones de bloqueo inesperadas en aplicaciones multithread, debemos proteger nuestras operaciones, especialmente aquéllas que modifican los datos mediante el uso de transacciones.</p>
<p>Una transacción define un entorno de ejecución en el que las operaciones de guardado se mantienen almacenadas en la memoria hasta que la transacción se complete. Si en un momento determinado algo falla, el estado se devuelve al punto inicial de la misma (punto inicial) oa algún punto de marca intermedio. Por defecto, abrir una <strong>conexión inicia una transacción</strong>:</p>
<ul>
<li>Cada ejecución en la conexión genera una transacción por sí misma.</li>
<li>Si queremos desactivar esta opción para que la transacción abarque varias ejecuciones, debemos marcarlo mediante <code>Connection.setAutoCommit(false);</code>.</li>
<li>Para aceptar definitivamente la transacción lo haremos mediante <code>Connection.commit();</code></li>
<li>Para cancelar la transacción <code>Connection.rollback();</code></li>
</ul>
<h2 id="66-resultsets-actualizables">6.6. ResultSets actualizables</h2>
<p>Los métodos de trabajo revisados en las secciones anteriores, especialmente cuando se actualizan o borran filas, funcionan directamente en la base de datos. Esto significa que borre o actualice una fila sin cargarla previamente en la memoria. ¿Qué ocurre si desea mostrar los datos al usuario y luego el usuario decide borrar o actualizar la fila? En este caso, es mejor utilizar ResultSets actualizables.</p>
<p>Hemos estudiado ResultSet como una colección de filas y lo utilizamos sólo para la lectura. También podemos utilizarlo para editar y borrar datos. Para ello, debemos abrir el ResultSet de una forma diferente a la que hemos visto hasta ahora. Y, por último, pero no menos importante, dependerá de la base de datos la disponibilidad de crear este tipo de ResultSets.</p>
<p>Para ello, no depende del ResultSet ni de cómo se creó el Statement. Debemos utilizar este constructor:</p>
<div class="language-java highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="kd">public</span><span class="w"> </span><span class="kd">abstract</span><span class="w"> </span><span class="n">Statement</span><span class="w"> </span><span class="nf">createStatement</span><span class="p">(</span><span class="w"> </span>
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a><span class="kt">int</span><span class="w"> </span><span class="n">arg0</span><span class="p">,</span><span class="w"> </span><span class="c1">// resultSetType </span>
</span><span id="__span-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a><span class="kt">int</span><span class="w"> </span><span class="n">arg1</span><span class="p">,</span><span class="w"> </span><span class="c1">// resultSetConcurrency </span>
</span><span id="__span-9-4"><a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a><span class="kt">int</span><span class="w"> </span><span class="n">arg2</span><span class="p">)</span><span class="w"> </span><span class="c1">// resultSetHoldability </span>
</span><span id="__span-9-5"><a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a><span class="kd">throws</span><span class="w"> </span><span class="n">SQLException</span>
</span></code></pre></div>
<p>Como puede ver, hay 3 argumentos para indicar qué tipo de ResultSet damos al final. Estos tres argumentos pueden ser:</p>
<ul>
<li><code>resultSetType</code> → éstas son opciones sobre cómo moverse y pasar por las filas del ResultSet: </li>
<li><code>TYPE_FORWARD_ONLY</code> → <strong>opción por defecto</strong>. El ResultSet sólo puede ocurrir una vez. </li>
<li><code>TYPE_SCROLL_INSENSITIVE</code> → Permite rebobinar y saltar a una posición absoluta o relativa. </li>
<li><code>TYPE_SCROLL_SENSITIVE</code> → Al igual que antes, pero permite ver los cambios realizados en la base de datos.</li>
<li><code>ResultSetConcurrency</code> → éstas son opciones sobre si se puede actualizar el ResultSet o no: </li>
<li><code>CONCUR_READ_ONLY</code> → <strong>opción por defecto</strong>. Sólo lectura. Si queremos actualizar algo, sólo podemos utilizar las cláusulas <code>DELETE</code> o <code>UPDATE</code>. </li>
<li><code>CONCUR_UPDATABLE</code> → Las filas de ResultSet se pueden actualizar o borrar.</li>
<li><code>ResultSetHoldability</code> → estas opciones son sobre el comportamiento al cerrar el ResultSet: </li>
<li><code>HOLD_CURSORS_OVER_COMMIT</code> → El ResultSet se mantiene abierto después de confirmar la transacción. </li>
<li><code>CLOSE_CURSORS_AT_COMMIT</code> → El ResultSet se cierra después de confirmar la transacción. Mejora el rendimiento.</li>
</ul>
<p>En el siguiente ejemplo, podemos preguntar a nuestro DBMS si estos tipos de ResultSet están soportados:</p>
<div class="language-java highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="n">ConexionDB</span><span class="w"> </span><span class="n">conDB</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ConexionDB</span><span class="p">(</span><span class="s">&quot;instituto&quot;</span><span class="p">);</span>
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a><span class="n">Connection</span><span class="w"> </span><span class="n">con</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">conDB</span><span class="p">.</span><span class="na">getConexion</span><span class="p">();</span>
</span><span id="__span-10-3"><a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a><span class="n">DatabaseMetaData</span><span class="w"> </span><span class="n">dbmd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">con</span><span class="p">.</span><span class="na">getMetaData</span><span class="p">();</span>
</span><span id="__span-10-4"><a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a>
</span><span id="__span-10-5"><a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;TYPE_FORWARD_ONLY: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">dbmd</span><span class="p">.</span><span class="na">supportsResultSetType</span><span class="p">(</span><span class="n">ResultSet</span><span class="p">.</span><span class="na">TYPE_FORWARD_ONLY</span><span class="p">));</span>
</span><span id="__span-10-6"><a id="__codelineno-10-6" name="__codelineno-10-6" href="#__codelineno-10-6"></a><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;TYPE_SCROLL_INSENSITIVE: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">dbmd</span><span class="p">.</span><span class="na">supportsResultSetType</span><span class="p">(</span><span class="n">ResultSet</span><span class="p">.</span><span class="na">TYPE_SCROLL_INSENSITIVE</span><span class="p">));</span>
</span><span id="__span-10-7"><a id="__codelineno-10-7" name="__codelineno-10-7" href="#__codelineno-10-7"></a><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;TYPE_SCROLL_SENSITIVE: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">dbmd</span><span class="p">.</span><span class="na">supportsResultSetType</span><span class="p">(</span><span class="n">ResultSet</span><span class="p">.</span><span class="na">TYPE_SCROLL_SENSITIVE</span><span class="p">));</span>
</span><span id="__span-10-8"><a id="__codelineno-10-8" name="__codelineno-10-8" href="#__codelineno-10-8"></a><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;CONCUR_READ_ONLY: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">dbmd</span><span class="p">.</span><span class="na">supportsResultSetConcurrency</span><span class="p">(</span><span class="n">ResultSet</span><span class="p">.</span><span class="na">TYPE_SCROLL_INSENSITIVE</span><span class="p">,</span><span class="w"> </span><span class="n">ResultSet</span><span class="p">.</span><span class="na">CONCUR_READ_ONLY</span><span class="p">));</span>
</span><span id="__span-10-9"><a id="__codelineno-10-9" name="__codelineno-10-9" href="#__codelineno-10-9"></a><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;CONCUR_UPDATABLE: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">dbmd</span><span class="p">.</span><span class="na">supportsResultSetConcurrency</span><span class="p">(</span><span class="n">ResultSet</span><span class="p">.</span><span class="na">TYPE_SCROLL_INSENSITIVE</span><span class="p">,</span><span class="w"> </span><span class="n">ResultSet</span><span class="p">.</span><span class="na">CONCUR_UPDATABLE</span><span class="p">));</span>
</span></code></pre></div>
<h3 id="661-movimiento-del-resultset">6.6.1. Movimiento del ResultSet</h3>
<p>Como podemos ver, no sólo podemos mover el cursor hacia delante:</p>
<ul>
<li><code>next</code>, <code>previous</code>, <code>first</code> y <code>last</code> → como su nombre indica, se mueven hacia delante, hacia atrás, al principio ya la última fila. Devuelve true si el cursor apunta a una fila y false de lo contrario.</li>
<li><code>beforeFirst</code> y <code>afterLast</code> → el cursor apuntará fuera de las filas, antes de la primera o después de la última fila.</li>
<li><code>relative(int n)</code> → el cursor se mueve <em>n</em> files (hacia adelante o hacia atrás, dependiendo del signo).</li>
<li><code>absolute(int n)</code> → el cursor apunta a la fila <em>n</em>.</li>
</ul>
<h3 id="662-eliminacion-de-filas-en-un-resultset">6.6.2. Eliminación de filas en un ResultSet</h3>
<p>Después de colocar el cursor en la fila que se desea eliminar, se puede eliminar del ResultSet (y de la base de datos) con el método <code>deleteRow()</code>. Cuando se elimina una fila, el cursor apuntará a la fila anterior a la que se ha eliminado.</p>
<h3 id="663-actualizacion-de-filas-en-un-resultset">6.6.3. Actualización de filas en un ResultSet</h3>
<p>Después de colocar el cursor en la fila deseada, se debe:</p>
<ol>
<li>Actualizar las columnas deseadas, utilizando el método <code>updateType(int column, type newValue)</code>, donde la columna i-ésima (o con su nombre) se asigna el nuevo valor del tipo dado.</li>
<li>Una vez que se hayan modificado todas las columnas deseadas, se guardan los cambios con <code>updateRow()</code>.</li>
</ol>
<div class="admonition tip">
<p class="admonition-title">Consejo</p>
</div>
<p>No podemos actualizar una fila entera, debemos actualizar columna por columna y después actualizar la fila.</p>
<h3 id="164-insercion-de-filas-en-un-resultset">1.6.4. Inserción de filas en un ResultSet</h3>
<p>Si queremos insertar una nueva fila en un ResultSet, debemos:</p>
<ol>
<li>Generar una nueva fila vacía, y esto se logra con el método <code>moveToInsertRow()</code>.</li>
<li>En esta fila, aplicamos el método <code>updateType(int column, type newValue)</code> a todas las columnas a las que queremos asignar un valor, y finalmente</li>
<li>Procedemos a insertar la nueva fila con <code>insertRow()</code>.</li>
</ol>
<div class="admonition note">
<p class="admonition-title">Importante</p>
</div>
<ul>
<li>Estas operaciones de actualización, eliminación e inserción sólo pueden realizarse en consultas que provienen de una tabla sin agrupaciones. </li>
<li>Para evitar complejidad en nuestros programas, vale la pena evaluar la conveniencia de traducir las actualizaciones del ResultSet a SQL puro y ejecutarlas directamente en las bases de datos mediante nuevas sentencias.</li>
</ul>
<p>Disponemos de todos los ejemplos en el proyecto <code>SentFija</code> en el siguiente <a href="../SentFija.zip">enlace</a>.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../5_Metadata.es/" class="md-footer__link md-footer__link--prev" aria-label="Previous: 5. Metadata de la base de datos">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                5. Metadata de la base de datos
              </div>
            </div>
          </a>
        
        
          
          <a href="../7_Row_to_Object.es/" class="md-footer__link md-footer__link--next" aria-label="Next: 7. De filas a Objetos">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                7. De filas a Objetos
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2025 Manu Romero
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://youtube.com/@ciclosformativosinfo" target="_blank" rel="noopener" title="youtube.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M23.498 6.186a3.02 3.02 0 0 0-2.122-2.136C19.505 3.545 12 3.545 12 3.545s-7.505 0-9.377.505A3.02 3.02 0 0 0 .502 6.186C0 8.07 0 12 0 12s0 3.93.502 5.814a3.02 3.02 0 0 0 2.122 2.136c1.871.505 9.376.505 9.376.505s7.505 0 9.377-.505a3.02 3.02 0 0 0 2.122-2.136C24 15.93 24 12 24 12s0-3.93-.502-5.814M9.545 15.568V8.432L15.818 12z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://bsky.app/profile/malsonvalencia.bsky.social" target="_blank" rel="noopener" title="bsky.app" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M5.202 2.857C7.954 4.922 10.913 9.11 12 11.358c1.087-2.247 4.046-6.436 6.798-8.501C20.783 1.366 24 .213 24 3.883c0 .732-.42 6.156-.667 7.037-.856 3.061-3.978 3.842-6.755 3.37 4.854.826 6.089 3.562 3.422 6.299-5.065 5.196-7.28-1.304-7.847-2.97-.104-.305-.152-.448-.153-.327 0-.121-.05.022-.153.327-.568 1.666-2.782 8.166-7.847 2.97-2.667-2.737-1.432-5.473 3.422-6.3-2.777.473-5.899-.308-6.755-3.369C.42 10.04 0 4.615 0 3.883c0-3.67 3.217-2.517 5.202-1.026"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.footer", "content.code.copy"], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
    
  </body>
</html>